<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FBIV VPN - Firebase Version</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json" />

<!-- PWA Meta Tags -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="FBIV VPN">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#004080" />
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Vue 3 (Global Build) -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --primary-color: #004080;
      --secondary-color: #00264d;
      --accent-color: #0066cc;
      --success-color: #28a745;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
      --bg-color: #f9fbfd;
      --text-color: #333;
      --card-bg: #ffffff;
      --border-color: #e0e0e0;
    }

    [data-theme="dark"] {
      --bg-color: #0f0f0f;
      --text-color: #f5f5f5;
      --card-bg: #1e1e1e;
      --border-color: #333333;
      --primary-color: #00aaff;
      --secondary-color: #1a4d80;
      --accent-color: #0099ff;
      --success-color: #00c851;
      --warning-color: #ffbb33;
      --danger-color: #ff4444;
    }

    body {
      background: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', sans-serif;
      transition: all 0.3s ease;
    }

    .hero {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      text-align: center;
      padding: 3rem 1rem;
      border-radius: 12px;
      margin: 20px 0;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="white" opacity="0.1"/></svg>') repeat;
      animation: float 20s infinite linear;
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      100% { transform: translateY(-100px); }
    }

    .card {
      border: none;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      background: var(--card-bg);
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }

    .btn-fbiv {
      background: var(--accent-color);
      border: none;
      padding: 12px 24px;
      border-radius: 30px;
      font-weight: 600;
      color: white;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .btn-fbiv:hover {
      background: #0055aa;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
    }

    .btn-fbiv::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .btn-fbiv:hover::before {
      left: 100%;
    }

    /* Connection Status Styles */
    .connection-status {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      padding: 10px 15px;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      color: white;
    }

    [data-theme="dark"] .connection-status {
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    }

    .status-connected {
      background: var(--success-color);
      color: white;
    }

    .status-disconnected {
      background: var(--danger-color);
      color: white;
    }

    .status-connecting {
      background: var(--warning-color);
      color: #333333;
    }

    [data-theme="dark"] .status-connecting {
      color: #1a1a1a;
    }

    /* Dashboard Styles */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .metric-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    .metric-value {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary-color);
      margin: 10px 0;
    }

    [data-theme="dark"] .metric-value {
      color: #00aaff;
    }

    [data-theme="dark"] .info-value {
      color: #00aaff;
      font-weight: 600;
    }

    /* Card improvements for dark mode */
    [data-theme="dark"] .card {
      background: #1e1e1e;
      border-color: #333333;
    }

    [data-theme="dark"] .card-header {
      background: #2a2a2a;
      border-bottom-color: #333333;
      color: #f0f0f0;
    }

    [data-theme="dark"] .card-body {
      color: #e0e0e0;
    }

    .metric-label {
      color: var(--text-color);
      opacity: 0.7;
      font-size: 0.9rem;
    }

    [data-theme="dark"] .metric-label {
      opacity: 0.85;
      color: #e0e0e0;
    }

    [data-theme="dark"] .info-label {
      color: #d0d0d0;
      opacity: 0.9;
    }

    [data-theme="dark"] .text-muted {
      color: #b0b0b0 !important;
    }

    [data-theme="dark"] .small.text-muted {
      color: #a0a0a0 !important;
    }

    /* Server List Enhanced */
    .server-item {
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 10px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .server-item:hover {
      background: var(--primary-color);
      color: white;
      transform: translateX(10px);
    }

    .server-item.connected {
      background: var(--success-color);
      color: white;
      border-color: var(--success-color);
    }

    /* Dark mode server list improvements */
    [data-theme="dark"] .server-item {
      background: #252525;
      border-color: #404040;
      color: #f0f0f0;
    }

    [data-theme="dark"] .server-item:hover {
      background: var(--primary-color);
      color: #ffffff;
    }

    [data-theme="dark"] .server-item.connected {
      background: var(--success-color);
      color: #ffffff;
      border-color: var(--success-color);
    }

    /* Professional Server Page Styles */
    .server-dashboard-header {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 2rem;
      border-radius: 10px;
      margin-bottom: 2rem;
    }

    .server-status-indicator {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .status-online { background-color: #10b981; }
    .status-warning { background-color: #f59e0b; }
    .status-offline { background-color: #ef4444; }

    .stat-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 1.5rem;
      text-align: center;
      transition: transform 0.2s;
    }

    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .stat-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .server-filters {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    .search-box input {
      border-radius: 25px;
      padding: 0.75rem 1.5rem;
    }

    .server-actions {
      background: var(--card-bg);
      padding: 1rem 1.5rem;
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    .view-toggle .btn {
      border-radius: 0;
    }

    .view-toggle .btn:first-child {
      border-top-left-radius: 5px;
      border-bottom-left-radius: 5px;
    }

    .view-toggle .btn:last-child {
      border-top-right-radius: 5px;
      border-bottom-right-radius: 5px;
    }

    .server-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.3s ease;
      height: 100%;
    }

    .server-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border-color: var(--primary-color);
    }

    .server-connected {
      border-color: var(--success-color) !important;
      box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
    }

    .server-premium {
      background: linear-gradient(145deg, #fef3c7, #fbbf24);
    }

    .server-selected {
      border-color: var(--warning-color) !important;
      background: rgba(251, 191, 36, 0.1);
    }

    .server-card-header {
      padding: 1.25rem 1.25rem 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }

    .server-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .flag-icon {
      font-size: 1.5rem;
    }

    .premium-badge {
      font-size: 0.8rem;
      background: linear-gradient(45deg, #fbbf24, #f59e0b);
      padding: 0.2rem 0.5rem;
      border-radius: 12px;
      color: white;
    }

    .server-subtitle {
      font-size: 0.85rem;
      margin: 0.25rem 0 0 0;
    }

    .server-card-body {
      padding: 1.25rem;
    }

    .performance-metrics {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 1rem;
    }

    .metric {
      text-align: center;
    }

    .metric-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
    }

    .metric-value {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .load-bar-container {
      width: 100%;
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
      margin: 0.25rem 0;
    }

    .load-bar {
      height: 100%;
      transition: width 0.3s;
    }

    .load-text {
      font-size: 0.8rem;
    }

    .ping-excellent { color: #10b981; }
    .ping-good { color: #059669; }
    .ping-fair { color: #f59e0b; }
    .ping-poor { color: #ef4444; }

    .server-details {
      border-top: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
      padding: 1rem 0;
    }

    .detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
    }

    .detail-label {
      color: var(--text-muted);
      font-weight: 500;
    }

    .detail-value {
      font-weight: 600;
    }

    .uptime-good {
      color: var(--success-color);
    }

    .server-features {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .feature-badge {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      border: 1px solid;
    }

    .feature-enabled {
      background: rgba(16, 185, 129, 0.1);
      border-color: #10b981;
      color: #059669;
    }

    .feature-disabled {
      background: rgba(156, 163, 175, 0.1);
      border-color: #9ca3af;
      color: #6b7280;
    }

    .user-stats {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .stats-item {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .server-card-footer {
      padding: 0 1.25rem 1.25rem;
    }

    .server-list-item {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      transition: all 0.2s;
    }

    .server-list-item:hover {
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .performance-indicator {
      text-align: center;
    }

    .ping-indicator {
      font-weight: 600;
      font-size: 1rem;
    }

    .load-indicator {
      text-align: center;
    }

    .load-bar-mini {
      width: 60px;
      height: 4px;
      background: #e5e7eb;
      border-radius: 2px;
      overflow: hidden;
      margin: 0 auto 0.25rem;
    }

    .features-mini {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .feature-mini {
      font-size: 0.75rem;
      font-weight: 500;
    }

    .server-actions-mini {
      display: flex;
      gap: 0.25rem;
    }

    .no-results {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      margin: 2rem 0;
    }

    /* Dark mode button improvements */
    [data-theme="dark"] .btn-outline-primary {
      color: var(--primary-color);
      border-color: var(--primary-color);
    }

    [data-theme="dark"] .btn-outline-primary:hover {
      background: var(--primary-color);
      color: #ffffff;
    }

    [data-theme="dark"] .btn-outline-success {
      color: var(--success-color);
      border-color: var(--success-color);
    }

    [data-theme="dark"] .btn-outline-info {
      color: #00aaff;
      border-color: #00aaff;
    }

    .server-load {
      display: inline-block;
      width: 60px;
      height: 6px;
      background: #e0e0e0;
      border-radius: 3px;
      overflow: hidden;
      margin-left: 10px;
    }

    .server-load-bar {
      height: 100%;
      transition: width 0.3s ease;
    }

    .load-low { background: var(--success-color); }
    .load-medium { background: var(--warning-color); }
    .load-high { background: var(--danger-color); }

    /* Theme Toggle */
    .theme-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 50px;
      padding: 8px 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--text-color);
    }

    .theme-toggle:hover {
      background: var(--primary-color);
      color: white;
    }

    [data-theme="dark"] .theme-toggle {
      background: #2a2a2a;
      border-color: #555555;
      color: #f0f0f0;
    }

    [data-theme="dark"] .theme-toggle:hover {
      background: var(--primary-color);
      color: #ffffff;
    }

    /* Professional Speed Test Styles */
    .speed-test-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2rem;
      border-radius: 15px;
      margin-bottom: 2rem;
    }

    .connection-indicator {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .speed-test-dashboard {
      margin-bottom: 2rem;
    }

    .speed-gauge-container {
      height: 100%;
    }

    .speed-gauge-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 2rem;
      height: 100%;
      text-align: center;
    }

    .speed-gauge-wrapper {
      position: relative;
      margin: 2rem 0;
    }

    .speed-gauge {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .speed-gauge.testing {
      animation: gaugeGlow 2s ease-in-out infinite alternate;
    }

    .gauge-svg {
      position: absolute;
      top: 0;
      left: 0;
    }

    .gauge-progress {
      transition: stroke-dashoffset 0.5s ease;
    }

    .speed-gauge.testing .gauge-progress {
      stroke: #f59e0b;
    }

    .gauge-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }

    .speed-value {
      font-size: 3rem;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .speed-unit {
      font-size: 1.2rem;
      color: var(--text-muted);
    }

    .speed-testing-animation {
      position: relative;
    }

    .pulse-ring {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120px;
      height: 120px;
      border: 3px solid var(--primary-color);
      border-radius: 50%;
      animation: pulseRing 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite;
    }

    .gauge-labels {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .gauge-label {
      position: absolute;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .gauge-low { bottom: 50px; left: 20px; }
    .gauge-mid { top: 20px; left: 50%; transform: translateX(-50%); }
    .gauge-high { bottom: 50px; right: 20px; }

    .speed-test-controls {
      margin-top: 2rem;
    }

    .speed-test-btn {
      width: 100%;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      margin-bottom: 1rem;
    }

    .quick-test-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 0.5rem;
    }

    .metrics-panel {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 1.5rem;
      height: 100%;
    }

    .current-metrics {
      margin-bottom: 1.5rem;
    }

    .metric-row {
      margin-bottom: 1rem;
    }

    .metric-item {
      display: flex;
      align-items: center;
      padding: 1rem;
      background: var(--bg-color);
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    .metric-icon {
      font-size: 1.5rem;
      margin-right: 1rem;
      width: 40px;
      text-align: center;
    }

    .metric-content {
      flex-grow: 1;
    }

    .metric-value {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 0.25rem;
    }

    .metric-label {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .metric-bar {
      width: 100%;
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
    }

    .metric-fill {
      height: 100%;
      transition: width 0.5s ease;
    }

    .download-fill { background: linear-gradient(90deg, #10b981, #059669); }
    .upload-fill { background: linear-gradient(90deg, #3b82f6, #2563eb); }
    .ping-fill { background: linear-gradient(90deg, #f59e0b, #d97706); }
    .jitter-fill { background: linear-gradient(90deg, #8b5cf6, #7c3aed); }

    .speed-quality {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-color);
    }

    .quality-indicator {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .quality-badge {
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 0.8rem;
    }

    .quality-excellent { background: #10b981; color: white; }
    .quality-good { background: #3b82f6; color: white; }
    .quality-fair { background: #f59e0b; color: white; }
    .quality-poor { background: #ef4444; color: white; }

    .quality-score {
      font-size: 1.1rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .speed-test-features {
      margin-bottom: 2rem;
    }

    .feature-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 1.5rem;
      height: 100%;
    }

    .feature-card h5 {
      margin-bottom: 1rem;
      color: var(--primary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
    }

    .history-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      background: var(--bg-color);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .history-time {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .history-speeds {
      display: flex;
      gap: 0.5rem;
      font-size: 0.8rem;
    }

    .history-speeds .download { color: #10b981; }
    .history-speeds .upload { color: #3b82f6; }
    .history-speeds .ping { color: #f59e0b; }

    .diagnostic-tools {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .diagnostic-results {
      margin-top: 1rem;
      padding: 1rem;
      background: var(--bg-color);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .server-speeds {
      max-height: 300px;
      overflow-y: auto;
    }

    .server-speed-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      background: var(--bg-color);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .server-flag {
      font-size: 1.5rem;
      margin-right: 0.75rem;
    }

    .server-details {
      flex-grow: 1;
    }

    .server-name {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .server-performance {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .server-performance .speed {
      color: #10b981;
      margin-right: 0.5rem;
    }

    .server-performance .ping {
      color: #f59e0b;
    }

    .speed-test-settings {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 1.5rem;
    }

    .settings-card {
      background: var(--bg-color);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 1.5rem;
      height: 100%;
    }

    .settings-card h6 {
      margin-bottom: 1rem;
      color: var(--primary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
    }

    .insights {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .insight-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: var(--card-bg);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .insight-icon {
      font-size: 1.2rem;
      margin-right: 0.75rem;
      width: 30px;
      text-align: center;
    }

    .insight-text {
      font-size: 0.9rem;
    }

    /* Animations */
    @keyframes gaugeGlow {
      0% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.3); }
      100% { box-shadow: 0 0 40px rgba(16, 185, 129, 0.6); }
    }

    @keyframes pulseRing {
      0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(0.5);
      }
      80%, 100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(1.2);
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .speed-gauge {
        width: 250px;
        height: 250px;
      }
      
      .gauge-background {
        width: 230px;
        height: 230px;
      }
      
      .gauge-fill {
        width: 240px;
        height: 240px;
      }
      
      .speed-value {
        font-size: 2rem;
      }
      
      .quick-test-buttons {
        grid-template-columns: 1fr;
      }
    }

    /* Professional Server Page Styles */
      font-weight: bold;
      color: var(--primary-color);
    }

    /* Analytics Charts */
    .chart-container {
      height: 300px;
      background: var(--card-bg);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid var(--border-color);
      margin: 20px 0;
    }

    .progress-ring {
      transform: rotate(-90deg);
    }

    .progress-ring-circle {
      transition: stroke-dasharray 0.35s;
      transform-origin: 50% 50%;
    }

    /* Button Close Styles */
    .btn-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--text-color);
      opacity: 0.7;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-close:hover {
      opacity: 1;
      color: var(--danger-color);
    }

    .btn-close::before {
      content: '×';
    }

    /* Modal Enhancements */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      z-index: 1040;
      backdrop-filter: blur(5px);
    }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1050;
      width: 90%;
      max-width: 500px;
      background: var(--card-bg);
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border-color);
    }

    .modal-header {
      background: var(--primary-color);
      color: white;
      border-radius: 15px 15px 0 0;
      padding: 15px 20px;
    }

    .modal-body {
      padding: 20px;
    }

    /* Form Enhancements */
    .form-control {
      background: var(--card-bg);
      border: 2px solid var(--border-color);
      border-radius: 10px;
      padding: 12px 15px;
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    .form-control:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 100, 200, 0.1);
      background: var(--card-bg);
      color: var(--text-color);
      outline: none;
    }

    [data-theme="dark"] .form-control {
      background: #2a2a2a;
      border-color: #555555;
      color: #f0f0f0;
    }

    [data-theme="dark"] .form-control:focus {
      background: #333333;
      border-color: var(--primary-color);
      color: #ffffff;
      box-shadow: 0 0 0 3px rgba(0, 170, 255, 0.2);
    }

    [data-theme="dark"] .form-control::placeholder {
      color: #999999;
    }

    .form-check-input:checked {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
    }

    /* Dark mode navbar improvements */
    [data-theme="dark"] .navbar {
      background: #1a1a1a !important;
      border-bottom: 1px solid #333333;
    }

    [data-theme="dark"] .navbar-brand {
      color: #ffffff !important;
    }

    [data-theme="dark"] .nav-link {
      color: #e0e0e0 !important;
    }

    [data-theme="dark"] .nav-link:hover {
      color: var(--primary-color) !important;
    }

    /* Dark mode modal improvements */
    [data-theme="dark"] .modal-header {
      background: linear-gradient(135deg, #1a4d80, #0d2c4a);
      color: #ffffff;
    }

    [data-theme="dark"] .modal-body {
      background: var(--card-bg);
      color: var(--text-color);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .connection-status {
        position: relative;
        top: auto;
        right: auto;
        margin: 10px;
        display: inline-block;
      }

      .theme-toggle {
        position: relative;
        top: auto;
        left: auto;
        margin: 10px;
        display: inline-block;
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
      }

      .hero {
        padding: 2rem 1rem;
      }
    }

    /* Loading and Animation */
    .loading {
      text-align: center;
      padding: 20px;
    }

    .spinner {
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-left: 3px solid var(--primary-color);
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    /* Server Details Modal */
    .server-details-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .server-details-content {
      background: var(--card-bg);
      border-radius: 16px;
      max-width: 1000px;
      width: 100%;
      max-height: 90vh;
      border: 2px solid var(--border-color);
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .server-header {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }

    .server-flag {
      font-size: 2.5rem;
      margin-right: 15px;
    }

    .server-title {
      flex-grow: 1;
    }

    .server-title h3 {
      margin: 0 0 5px 0;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .server-status {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .server-modal-body {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      height: 100%;
      overflow: hidden;
    }

    .left-column,
    .right-column {
      padding: 20px;
      overflow-y: auto;
      max-height: calc(90vh - 100px);
    }

    .left-column {
      border-right: 1px solid var(--border-color);
    }

    .section {
      margin-bottom: 20px;
    }

    .section h5 {
      margin: 0 0 12px 0;
      font-size: 1rem;
      font-weight: 600;
      color: var(--primary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 5px;
    }

    .compact-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .stat-item {
      text-align: center;
      padding: 12px;
      background: var(--bg-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    .stat-value {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .info-grid {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .info-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: var(--bg-color);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 0.9rem;
    }

    .info-label {
      font-weight: 500;
      color: var(--text-muted);
    }

    .info-value {
      font-weight: 600;
    }

    .features-compact {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .feature-compact {
      display: flex;
      align-items: center;
      padding: 10px 12px;
      border: 1px solid;
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .feature-compact.feature-enabled {
      background: rgba(16, 185, 129, 0.1);
      border-color: #10b981;
      color: #059669;
    }

    .feature-compact.feature-disabled {
      background: rgba(156, 163, 175, 0.1);
      border-color: #9ca3af;
      color: #6b7280;
    }

    .feature-icon {
      margin-right: 10px;
      font-size: 1.1rem;
    }

    .feature-text {
      flex-grow: 1;
      font-weight: 500;
    }

    .feature-status {
      font-weight: bold;
    }

    .connection-buttons-compact {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .btn-block {
      width: 100%;
      padding: 12px;
      font-weight: 600;
    }

    .action-buttons-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .action-buttons-row .btn {
      padding: 8px 12px;
      font-size: 0.85rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .server-modal-body {
        grid-template-columns: 1fr;
      }
      
      .left-column {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        max-height: none;
        overflow: visible;
      }
      
      .right-column {
        max-height: none;
        overflow: visible;
      }
      
      .server-details-content {
        max-height: 95vh;
        overflow-y: auto;
      }
      
      .compact-stats {
        grid-template-columns: 1fr;
      }
    }
      color: var(--primary-color);
      font-weight: bold;
    }

    .server-title .server-status {
      color: var(--success-color);
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .server-stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .server-stat {
      background: var(--bg-color);
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      border: 1px solid var(--border-color);
    }

    .server-stat-value {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .server-stat-label {
      color: var(--text-color);
      opacity: 0.7;
      font-size: 0.9rem;
    }

    .server-features {
      margin: 30px 0;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .feature-item {
      display: flex;
      align-items: center;
      padding: 15px;
      background: var(--bg-color);
      border-radius: 10px;
      border: 1px solid var(--border-color);
    }

    .feature-icon {
      font-size: 1.5rem;
      margin-right: 10px;
    }

    .server-map {
      background: var(--bg-color);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      border: 1px solid var(--border-color);
    }

    .connection-buttons {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .btn-connect-primary {
      background: var(--success-color);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 50px;
      font-weight: bold;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      flex-grow: 1;
      min-width: 200px;
    }

    .btn-connect-primary:hover {
      background: #1e7e34;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
    }

    .btn-disconnect {
      background: var(--danger-color);
      color: white;
    }

    .btn-disconnect:hover {
      background: #c82333;
    }

    .btn-secondary {
      background: transparent;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
      padding: 15px 30px;
      border-radius: 50px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background: var(--primary-color);
      color: white;
    }

    footer {
      margin-top: 3rem;
      background: var(--secondary-color);
      color: #ccc;
      padding: 2rem 0;
      text-align: center;
      font-size: 0.9rem;
    }

    [data-theme="dark"] footer {
      background: #0d0d0d;
      color: #b0b0b0;
    }

    /* General text improvements for dark mode */
    [data-theme="dark"] h1,
    [data-theme="dark"] h2,
    [data-theme="dark"] h3,
    [data-theme="dark"] h4,
    [data-theme="dark"] h5 {
      color: #f5f5f5;
    }

    [data-theme="dark"] p {
      color: #e0e0e0;
    }

    [data-theme="dark"] .text-success {
      color: #00c851 !important;
    }

    [data-theme="dark"] .text-primary {
      color: #00aaff !important;
    }

    [data-theme="dark"] .text-info {
      color: #33b5e5 !important;
    }

    [data-theme="dark"] .badge {
      background: #333333;
      color: #f0f0f0;
    }

    [data-theme="dark"] .badge.bg-success {
      background: var(--success-color) !important;
    }

    /* Enhanced Home Page Styles */
    .section-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .section-header h2 {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
    }

    .section-header p {
      font-size: 1.1rem;
      opacity: 0.8;
      max-width: 600px;
      margin: 0 auto;
    }

    /* Hero Stats */
    .stat-item {
      padding: 1rem;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: white;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .stat-label {
      font-size: 0.9rem;
      opacity: 0.9;
      color: white;
    }

    /* Server Quick List */
    .server-quick-list {
      max-height: 400px;
      overflow-y: auto;
    }

    .server-quick-item {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .server-quick-item:hover {
      background: rgba(0, 100, 200, 0.1);
      transform: translateX(5px);
    }

    .server-quick-item .server-flag {
      font-size: 1.5rem;
      margin-right: 15px;
    }

    .server-quick-item .server-info {
      flex: 1;
    }

    .server-quick-item .server-status {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-right: 15px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .status-dot.excellent { background: #28a745; }
    .status-dot.good { background: #ffc107; }
    .status-dot.busy { background: #dc3545; }

    /* Network Metrics */
    .network-metric {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .network-metric:last-child {
      border-bottom: none;
    }

    /* Feature Cards */
    .feature-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      height: 100%;
      transition: all 0.3s ease;
      margin-bottom: 20px;
    }

    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }

    .feature-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .feature-list {
      list-style: none;
      padding: 0;
      margin-top: 15px;
    }

    .feature-list li {
      padding: 5px 0;
      color: var(--text-color);
      opacity: 0.8;
    }

    .feature-list li:before {
      content: "✓ ";
      color: var(--success-color);
      font-weight: bold;
    }

    /* Security Features */
    .security-feature {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      margin-bottom: 15px;
      transition: all 0.3s ease;
    }

    .security-feature:hover {
      border-color: var(--primary-color);
    }

    .security-icon {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .security-feature h6 {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--text-color);
    }

    .security-feature p {
      font-size: 0.9rem;
      opacity: 0.8;
      margin: 0;
    }

    /* Testimonials */
    .testimonial-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }

    .testimonial-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .testimonial-rating {
      font-size: 1.2rem;
      margin-bottom: 15px;
    }

    .testimonial-author {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid var(--border-color);
    }

    .testimonial-author strong {
      color: var(--primary-color);
    }

    .testimonial-author small {
      display: block;
      opacity: 0.7;
      margin-top: 3px;
    }

    /* FAQ Section */
    .faq-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .faq-item {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      margin-bottom: 15px;
      overflow: hidden;
    }

    .faq-question {
      padding: 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      background: var(--card-bg);
      transition: all 0.3s ease;
    }

    .faq-question:hover {
      background: rgba(0, 100, 200, 0.05);
    }

    .faq-toggle {
      font-size: 1.5rem;
      color: var(--primary-color);
      font-weight: bold;
    }

    .faq-answer {
      padding: 0 20px 20px;
      color: var(--text-color);
      opacity: 0.9;
    }

    /* Trust Indicators */
    .trust-indicators {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 2rem;
    }

    .trust-item {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
    }

    .trust-icon {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    .trust-item h6 {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--primary-color);
    }

    /* Dark mode adjustments for new elements */
    [data-theme="dark"] .feature-card,
    [data-theme="dark"] .security-feature,
    [data-theme="dark"] .testimonial-card,
    [data-theme="dark"] .faq-item,
    [data-theme="dark"] .trust-item {
      background: #1e1e1e;
      border-color: #333333;
    }

    [data-theme="dark"] .server-quick-item:hover {
      background: rgba(0, 170, 255, 0.1);
    }

    [data-theme="dark"] .faq-question:hover {
      background: rgba(0, 170, 255, 0.05);
    }

    /* Professional Loading Overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Color Wheel Spinner */
    .color-wheel-spinner {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      position: relative;
      animation: spin 1s linear infinite;
      background: conic-gradient(
        from 0deg,
        #ff0000 0deg,
        #ff8800 60deg,
        #ffff00 120deg,
        #88ff00 180deg,
        #00ff88 240deg,
        #0088ff 300deg,
        #8800ff 360deg
      );
      box-shadow: 0 0 30px rgba(0, 150, 255, 0.3);
    }

    .color-wheel-spinner::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 60px;
      height: 60px;
      background: var(--bg-color);
      border-radius: 50%;
      transform: translate(-50%, -50%);
    }

    .color-wheel-spinner::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      background: var(--primary-color);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes pulse {
      0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.7; }
    }

    /* Loading Text */
    .loading-text {
      position: absolute;
      top: 120px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      text-align: center;
      animation: fadeInOut 2s ease-in-out infinite;
    }

    [data-theme="dark"] .loading-text {
      color: #f0f0f0;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    @keyframes fadeInOut {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }

    /* Blur effect for main content during loading */
    .content-blur {
      filter: blur(3px);
      transition: filter 0.3s ease;
    }

    /* Confetti Animation for Server Connection */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10000;
      overflow: hidden;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: confetti-fall 3s linear infinite;
    }

    .confetti.square {
      border-radius: 0;
      width: 8px;
      height: 8px;
    }

    .confetti.triangle {
      width: 0;
      height: 0;
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 8px solid;
      border-radius: 0;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Success Message Overlay */
    .success-overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10001;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 30px 40px;
      border-radius: 20px;
      text-align: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 2px solid var(--success-color);
    }

    .success-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .success-icon {
      font-size: 3rem;
      margin-bottom: 15px;
      animation: bounceIn 0.6s ease-out;
    }

    @keyframes bounceIn {
      0% {
        transform: scale(0.3);
        opacity: 0;
      }
      50% {
        transform: scale(1.05);
      }
      70% {
        transform: scale(0.9);
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .success-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--success-color);
    }

    .success-message {
      font-size: 1rem;
      opacity: 0.9;
    }

    /* Enhanced loading states for buttons */
    .btn-loading {
      position: relative;
      pointer-events: none;
      opacity: 0.7;
    }

    .btn-loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 16px;
      height: 16px;
      margin: -8px 0 0 -8px;
      border: 2px solid transparent;
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      z-index: 1040;
    }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1050;
      width: 90%;
      max-width: 500px;
      background: white;
      border-radius: 10px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .btn-close {
      background: none;
      border: none;
      font-size: 1.25rem;
      cursor: pointer;
      opacity: 0.5;
    }

    .btn-close:hover {
      opacity: 1;
    }

    footer {
      margin-top: 3rem;
      background: #00264d;
      color: #ccc;
      padding: 2rem 0;
      text-align: center;
      font-size: 0.9rem;
    }

    .loading {
      text-align: center;
      padding: 20px;
    }

    .spinner {
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-left: 3px solid #0066cc;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Responsive improvements */
    @media (max-width: 768px) {
      .hero {
        padding: 2rem 1rem;
      }
      
      .modal {
        width: 95%;
        margin: 10px;
      }
      
      .card {
        margin-bottom: 15px;
      }
    }

    /* Fix for button accessibility */
    .btn-close::before {
      content: "×";
    }
  </style>
</head>

<body>

  <!-- Professional Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div>
      <div class="color-wheel-spinner"></div>
      <div class="loading-text" id="loading-text">Loading FBIV VPN...</div>
    </div>
  </div>

  <script>
    // Show loading immediately
    document.getElementById('loading-overlay').classList.add('active');
    
    // Hide loading after page loads, regardless of Vue
    window.addEventListener('load', function() {
      setTimeout(function() {
        const overlay = document.getElementById('loading-overlay');
        if (overlay) {
          overlay.classList.remove('active');
        }
      }, 1000);
    });
  </script>

  <!-- Confetti Container -->
  <div id="confetti-container" class="confetti-container"></div>

  <!-- Success Overlay -->
  <div id="success-overlay" class="success-overlay">
    <div class="success-icon">🎉</div>
    <div class="success-title">Connected Successfully!</div>
    <div class="success-message" id="success-message">You're now connected to the VPN server</div>
  </div>

  <div id="app" :class="{ 'content-blur': isLoading }">

    <!-- Theme Toggle -->
    <div class="theme-toggle" @click="toggleTheme" title="Toggle Theme">
      {{ isDarkTheme ? '☀️' : '🌙' }}
    </div>

    <!-- Connection Status -->
    <div class="connection-status" :class="connectionStatusClass">
      <span v-if="connectionStatus === 'connected'">🔒 Connected to {{ connectedServer?.location || 'VPN' }}</span>
      <span v-else-if="connectionStatus === 'connecting'" class="pulse">🔄 Connecting...</span>
      <span v-else>🔓 Disconnected</span>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: #00264d;">
      <div class="container">
        <a class="navbar-brand fw-bold" href="#" @click="setPage('home')">FBIV <span class="text-info">VPN</span></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="nav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('home')">🏠 Home</a></li>
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('servers')">🌍 Servers</a></li>
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('dashboard')" v-if="isLoggedIn">📊 Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('speedtest')">⚡ Speed Test</a></li>
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('security')">🛡️ Security</a></li>
            <li class="nav-item"><a class="nav-link" href="#" @click="setPageWithLoading('pricing')">💎 Pricing</a></li>
            <li class="nav-item" v-if="isLoggedIn"><a class="nav-link" href="#" @click="setPageWithLoading('account')">👤 Account</a></li>
          </ul>
          <div class="d-flex" v-if="!isLoggedIn">
            <button class="btn btn-outline-light me-2" @click="showModal='login'">Login</button>
            <button class="btn btn-info" @click="showModal='register'">Join FBIV</button>
          </div>
          <div class="d-flex" v-else>
            <button class="btn btn-danger" @click="logout">Logout</button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">

      <!-- Home -->
      <div v-if="page === 'home'">
        <!-- Hero Section -->
        <div class="hero">
          <h1>FBIV VPN</h1>
          <p class="lead">Fast • Bulletproof • Invisible</p>
          <p>Military-grade encryption meets lightning-fast speeds. Protect your digital life with the world's most advanced VPN.</p>
          <div class="mt-4">
            <button class="btn btn-success btn-lg me-3" @click="setPageWithLoading('pricing')">🔐 Get Protected Now</button>
            <button class="btn btn-outline-light btn-lg" @click="setPageWithLoading('speedtest')">⚡ Test Speed</button>
          </div>
          
          <!-- Live Stats -->
          <div class="row mt-5 text-center">
            <div class="col-md-3">
              <div class="stat-item">
                <div class="stat-number">{{ totalUsers.toLocaleString() }}</div>
                <div class="stat-label">Active Users</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-item">
                <div class="stat-number">{{ totalServers }}</div>
                <div class="stat-label">Global Servers</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-item">
                <div class="stat-number">{{ totalCountries }}+</div>
                <div class="stat-label">Countries</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-item">
                <div class="stat-number">99.9%</div>
                <div class="stat-label">Uptime</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Real-time Server Status -->
        <div class="section-header mt-5">
          <h2>🌍 Real-time Global Network</h2>
          <p>Our servers are online and ready to protect you</p>
        </div>
        
        <div class="row">
          <div class="col-md-8">
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h5>🚀 Fastest Servers Right Now</h5>
                <button class="btn btn-sm btn-outline-primary" @click="refreshServerStats">🔄 Refresh</button>
              </div>
              <div class="card-body">
                <div class="server-quick-list">
                  <div v-for="server in topServers" :key="server.id" class="server-quick-item" @click="quickConnect(server)">
                    <div class="server-flag">{{ server.flag }}</div>
                    <div class="server-info">
                      <strong>{{ server.location }}</strong>
                      <small class="text-muted d-block">{{ server.ping }}ms • {{ server.load }}% load</small>
                    </div>
                    <div class="server-status">
                      <span class="status-dot" :class="getStatusClass(server.load)"></span>
                      <small>{{ getServerStatus(server.load) }}</small>
                    </div>
                    <button class="btn btn-sm btn-success" @click.stop="quickConnect(server)">Connect</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-4">
            <div class="card" @click="showNetworkDetails" style="cursor: pointer;">
              <div class="card-header">
                <h5>📊 Network Health</h5>
                <small class="text-muted">Click for details</small>
              </div>
              <div class="card-body">
                <div class="network-metric">
                  <div class="metric-label">Average Speed</div>
                  <div class="metric-value text-success">{{ networkStats.avgSpeed }} Mbps</div>
                </div>
                <div class="network-metric">
                  <div class="metric-label">Global Load</div>
                  <div class="metric-value" :class="getLoadStatusColor(networkStats.globalLoad)">{{ networkStats.globalLoad }}%</div>
                </div>
                <div class="network-metric">
                  <div class="metric-label">Active Connections</div>
                  <div class="metric-value text-info">{{ networkStats.activeConnections.toLocaleString() }}</div>
                </div>
                <div class="network-metric">
                  <div class="metric-label">Data Protected</div>
                  <div class="metric-value text-primary">{{ networkStats.dataProtected }} TB</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Feature Showcase -->
        <div class="section-header mt-5">
          <h2>🛡️ Why Choose FBIV VPN?</h2>
          <p>Advanced features that keep you safe and connected</p>
        </div>
        
        <div class="row mt-4">
          <div class="col-md-4">
            <div class="feature-card" @click="showEncryptionDetails">
              <div class="feature-icon">🔐</div>
              <h5>Military-Grade Encryption</h5>
              <p>AES-256 encryption with perfect forward secrecy. Your data is unbreakable.</p>
              <ul class="feature-list">
                <li>ChaCha20 cipher</li>
                <li>RSA-4096 handshake</li>
                <li>SHA-384 authentication</li>
              </ul>
              <button class="btn btn-outline-primary btn-sm mt-3" @click.stop="showEncryptionDetails">Learn More</button>
            </div>
          </div>
          
          <div class="col-md-4">
            <div class="feature-card" @click="setPageWithLoading('speedtest')">
              <div class="feature-icon">⚡</div>
              <h5>Lightning Fast Speeds</h5>
              <p>Optimized for streaming, gaming, and large downloads without slowdowns.</p>
              <ul class="feature-list">
                <li>10 Gbps servers</li>
                <li>Smart routing</li>
                <li>Bandwidth unlimited</li>
              </ul>
              <button class="btn btn-outline-primary btn-sm mt-3" @click.stop="setPageWithLoading('speedtest')">Test Speed</button>
            </div>
          </div>
          
          <div class="col-md-4">
            <div class="feature-card" @click="setPageWithLoading('servers')">
              <div class="feature-icon">🌍</div>
              <h5>Global Access</h5>
              <p>Bypass geo-restrictions and access content from anywhere in the world.</p>
              <ul class="feature-list">
                <li>60+ countries</li>
                <li>500+ servers</li>
                <li>Smart location</li>
              </ul>
              <button class="btn btn-outline-primary btn-sm mt-3" @click.stop="setPageWithLoading('servers')">View Servers</button>
            </div>
          </div>
        </div>

        <!-- Security Features Grid -->
        <div class="row mt-4">
          <div class="col-md-3">
            <div class="security-feature" @click="setPageWithLoading('security')">
              <div class="security-icon">🛡️</div>
              <h6>Kill Switch</h6>
              <p>Automatic protection if VPN drops</p>
              <small class="text-primary">Click to configure →</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="security-feature" @click="setPageWithLoading('security')">
              <div class="security-icon">🔄</div>
              <h6>Split Tunneling</h6>
              <p>Choose which apps use VPN</p>
              <small class="text-primary">Click to configure →</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="security-feature" @click="setPageWithLoading('security')">
              <div class="security-icon">🚫</div>
              <h6>Ad Blocker</h6>
              <p>Block ads and trackers</p>
              <small class="text-primary">Click to configure →</small>
            </div>
          </div>
          <div class="col-md-3">
            <div class="security-feature" @click="setPageWithLoading('security')">
              <div class="security-icon">🔒</div>
              <h6>DNS Protection</h6>
              <p>Prevent DNS leaks</p>
              <small class="text-primary">Click to configure →</small>
            </div>
          </div>
        </div>

        <!-- Testimonials -->
        <div class="section-header mt-5">
          <h2>💬 What Users Say</h2>
          <p>Join millions of satisfied customers worldwide</p>
        </div>
        
        <div class="row">
          <div class="col-md-4">
            <div class="testimonial-card">
              <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
              <p>"FBIV VPN is incredibly fast and reliable. I can stream 4K content without any buffering!"</p>
              <div class="testimonial-author">
                <strong>Sarah M.</strong>
                <small>Netflix Enthusiast</small>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="testimonial-card">
              <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
              <p>"Perfect for gaming. Low latency and no disconnects. My ping is actually better with FBIV!"</p>
              <div class="testimonial-author">
                <strong>Alex K.</strong>
                <small>Pro Gamer</small>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="testimonial-card">
              <div class="testimonial-rating">⭐⭐⭐⭐⭐</div>
              <p>"As a journalist, privacy is crucial. FBIV VPN keeps my sources and data completely secure."</p>
              <div class="testimonial-author">
                <strong>Maria R.</strong>
                <small>Investigative Reporter</small>
              </div>
            </div>
          </div>
        </div>

        <!-- FAQ Section -->
        <div class="section-header mt-5">
          <h2>❓ Frequently Asked Questions</h2>
        </div>
        
        <div class="faq-container">
          <div class="faq-item" v-for="(faq, index) in faqs" :key="index">
            <div class="faq-question" @click="toggleFaq(index)">
              <span>{{ faq.question }}</span>
              <span class="faq-toggle">{{ openFaqs.includes(index) ? '−' : '+' }}</span>
            </div>
            <div class="faq-answer" v-show="openFaqs.includes(index)">
              <p>{{ faq.answer }}</p>
            </div>
          </div>
        </div>

        <!-- Trust Indicators -->
        <div class="section-header mt-5">
          <h2>🏆 Trusted Worldwide</h2>
        </div>
        
        <div class="trust-indicators">
          <div class="trust-item" @click="showCertificationDetails" style="cursor: pointer;">
            <div class="trust-icon">🔒</div>
            <h6>SOC 2 Certified</h6>
            <p>Independently audited security</p>
            <small class="text-primary">View certificate →</small>
          </div>
          <div class="trust-item" @click="showPrivacyPolicy" style="cursor: pointer;">
            <div class="trust-icon">🛡️</div>
            <h6>No-Log Policy</h6>
            <p>Verified by third parties</p>
            <small class="text-primary">Read policy →</small>
          </div>
          <div class="trust-item" @click="showAwards" style="cursor: pointer;">
            <div class="trust-icon">🌟</div>
            <h6>Award Winning</h6>
            <p>Best VPN 2025</p>
            <small class="text-primary">View awards →</small>
          </div>
          <div class="trust-item" @click="showOpenSource" style="cursor: pointer;">
            <div class="trust-icon">💚</div>
            <h6>Open Source</h6>
            <p>Transparent code</p>
            <small class="text-primary">View source →</small>
          </div>
        </div>
      </div>

      <!-- Dashboard -->
      <div v-else-if="page === 'dashboard' && isLoggedIn">
        <h2>📊 Dashboard</h2>
        <div class="dashboard-grid">
          <div class="metric-card">
            <div class="metric-value">{{ dataUsage.toFixed(2) }} GB</div>
            <div class="metric-label">Data Used Today</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">{{ connectionTime }}</div>
            <div class="metric-label">Connected Time</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">{{ downloadSpeed }} Mbps</div>
            <div class="metric-label">Download Speed</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">{{ uploadSpeed }} Mbps</div>
            <div class="metric-label">Upload Speed</div>
          </div>
        </div>

        <div class="row mt-4">
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>📈 Usage Analytics</h5>
              </div>
              <div class="card-body">
                <canvas id="usageChart" width="400" height="200"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>🔒 Connection History</h5>
              </div>
              <div class="card-body">
                <div v-for="session in connectionHistory" :key="session.id" class="d-flex justify-content-between align-items-center mb-2">
                  <div>
                    <strong>{{ session.server }}</strong>
                    <small class="text-muted d-block">{{ session.date }}</small>
                  </div>
                  <span class="badge bg-success">{{ session.duration }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Professional Speed Test Page -->
      <div v-else-if="page === 'speedtest'">
        <!-- Speed Test Header -->
        <div class="speed-test-header">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h2 class="mb-2">⚡ Professional Speed Test</h2>
              <p class="text-muted">Advanced network performance analyzer with real-time metrics and detailed diagnostics</p>
            </div>
            <div class="col-md-4 text-end">
              <div class="connection-indicator">
                <span class="status-dot" :class="connectionStatus === 'connected' ? 'status-online' : 'status-offline'"></span>
                <span class="small">{{ connectionStatus === 'connected' ? 'VPN Active' : 'Direct Connection' }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Speed Test Dashboard -->
        <div class="speed-test-dashboard">
          <div class="row">
            <!-- Main Speed Gauge -->
            <div class="col-lg-6">
              <div class="speed-gauge-container">
                <div class="speed-gauge-card">
                  <h4 class="text-center mb-4">🎯 Current Speed</h4>
                  <div class="speed-gauge-wrapper">
                    <div class="speed-gauge" :class="{ 'testing': speedTesting }">
                      <svg class="gauge-svg" viewBox="0 0 200 200" width="300" height="300">
                        <!-- Background circle -->
                        <circle cx="100" cy="100" r="90" fill="none" stroke="#e5e7eb" stroke-width="10"></circle>
                        <!-- Progress circle -->
                        <circle cx="100" cy="100" r="90" fill="none" stroke="#10b981" stroke-width="10"
                                stroke-linecap="round"
                                :stroke-dasharray="565.48"
                                :stroke-dashoffset="565.48 - (565.48 * getGaugeRotation() / 270)"
                                transform="rotate(-90 100 100)"
                                class="gauge-progress">
                        </circle>
                      </svg>
                      <div class="gauge-center">
                        <div class="speed-value">
                          <span v-if="!speedTesting">{{ currentTestSpeed || '0' }}</span>
                          <div v-else class="speed-testing-animation">
                            <div class="pulse-ring"></div>
                            <span>{{ currentTestSpeed || '0' }}</span>
                          </div>
                        </div>
                        <div class="speed-unit">Mbps</div>
                      </div>
                      <div class="gauge-labels">
                        <span class="gauge-label gauge-low">0</span>
                        <span class="gauge-label gauge-mid">500</span>
                        <span class="gauge-label gauge-high">1000</span>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Test Controls -->
                  <div class="speed-test-controls">
                    <button 
                      class="btn btn-primary btn-lg speed-test-btn" 
                      @click="startComprehensiveSpeedTest" 
                      :disabled="speedTesting">
                      <span v-if="!speedTesting">
                        <i class="fas fa-rocket"></i> Start Comprehensive Test
                      </span>
                      <span v-else>
                        <i class="fas fa-spinner fa-spin"></i> {{ testingPhase }}
                      </span>
                    </button>
                    
                    <div class="quick-test-buttons">
                      <button class="btn btn-outline-info" @click="quickDownloadTest" :disabled="speedTesting">
                        📥 Quick Download
                      </button>
                      <button class="btn btn-outline-success" @click="quickUploadTest" :disabled="speedTesting">
                        📤 Quick Upload
                      </button>
                      <button class="btn btn-outline-warning" @click="pingTest" :disabled="speedTesting">
                        📡 Ping Test
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Real-time Metrics -->
            <div class="col-lg-6">
              <div class="metrics-panel">
                <h4 class="mb-3">📊 Real-time Metrics</h4>
                
                <!-- Current Test Results -->
                <div class="current-metrics" v-if="speedTestResults || speedTesting">
                  <div class="metric-row">
                    <div class="metric-item download">
                      <div class="metric-icon">📥</div>
                      <div class="metric-content">
                        <div class="metric-value">{{ speedTestResults?.download || currentDownloadSpeed || '0' }} Mbps</div>
                        <div class="metric-label">Download Speed</div>
                        <div class="metric-bar">
                          <div class="metric-fill download-fill" :style="{ width: getDownloadPercent() + '%' }"></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="metric-row">
                    <div class="metric-item upload">
                      <div class="metric-icon">📤</div>
                      <div class="metric-content">
                        <div class="metric-value">{{ speedTestResults?.upload || currentUploadSpeed || '0' }} Mbps</div>
                        <div class="metric-label">Upload Speed</div>
                        <div class="metric-bar">
                          <div class="metric-fill upload-fill" :style="{ width: getUploadPercent() + '%' }"></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="metric-row">
                    <div class="metric-item ping">
                      <div class="metric-icon">📡</div>
                      <div class="metric-content">
                        <div class="metric-value">{{ speedTestResults?.ping || currentPing || '0' }} ms</div>
                        <div class="metric-label">Latency (Ping)</div>
                        <div class="metric-bar">
                          <div class="metric-fill ping-fill" :style="{ width: getPingPercent() + '%' }"></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="metric-row">
                    <div class="metric-item jitter">
                      <div class="metric-icon">📈</div>
                      <div class="metric-content">
                        <div class="metric-value">{{ speedTestResults?.jitter || currentJitter || '0' }} ms</div>
                        <div class="metric-label">Jitter</div>
                        <div class="metric-bar">
                          <div class="metric-fill jitter-fill" :style="{ width: getJitterPercent() + '%' }"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Speed Quality Indicator -->
                <div class="speed-quality" v-if="speedTestResults">
                  <h6>📶 Connection Quality</h6>
                  <div class="quality-indicator">
                    <div class="quality-badge" :class="getQualityClass()">
                      {{ getQualityText() }}
                    </div>
                    <div class="quality-score">Score: {{ getQualityScore() }}/100</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Advanced Features -->
        <div class="speed-test-features">
          <div class="row">
            <!-- Test History -->
            <div class="col-lg-4">
              <div class="feature-card">
                <h5>📈 Test History</h5>
                <div class="history-list">
                  <div class="history-item" v-for="(test, index) in speedHistory.slice(0, 5)" :key="index">
                    <div class="history-time">{{ test.time }}</div>
                    <div class="history-speeds">
                      <span class="download">↓{{ test.download }}</span>
                      <span class="upload">↑{{ test.upload }}</span>
                      <span class="ping">{{ test.ping }}ms</span>
                    </div>
                  </div>
                  <button class="btn btn-sm btn-outline-primary mt-2" @click="exportHistory">
                    📊 Export Full History
                  </button>
                </div>
              </div>
            </div>

            <!-- Network Diagnostics -->
            <div class="col-lg-4">
              <div class="feature-card">
                <h5>🔧 Network Diagnostics</h5>
                <div class="diagnostic-tools">
                  <button class="btn btn-outline-info btn-sm mb-2" @click="runNetworkDiagnostic" :disabled="diagnosticRunning">
                    <i class="fas fa-stethoscope"></i> Full Diagnostic
                  </button>
                  <button class="btn btn-outline-warning btn-sm mb-2" @click="checkDNSSpeed">
                    🌐 DNS Speed Test
                  </button>
                  <button class="btn btn-outline-success btn-sm mb-2" @click="checkPacketLoss">
                    📦 Packet Loss Test
                  </button>
                  <button class="btn btn-outline-danger btn-sm mb-2" @click="runSpeedComparison">
                    ⚖️ VPN vs Direct
                  </button>
                  
                  <div class="diagnostic-results" v-if="diagnosticResults">
                    <div class="small">
                      <div><strong>DNS Resolution:</strong> {{ diagnosticResults.dns }}ms</div>
                      <div><strong>Packet Loss:</strong> {{ diagnosticResults.packetLoss }}%</div>
                      <div><strong>Route Hops:</strong> {{ diagnosticResults.hops }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Servers -->
            <div class="col-lg-4">
              <div class="feature-card">
                <h5>🌍 Server Performance</h5>
                <div class="server-speeds">
                  <div class="server-speed-item" v-for="server in topPerformingServers" :key="server.id">
                    <div class="server-flag">{{ server.flag }}</div>
                    <div class="server-details">
                      <div class="server-name">{{ server.location }}</div>
                      <div class="server-performance">
                        <span class="speed">{{ server.avgSpeed }}Mbps</span>
                        <span class="ping">{{ server.ping }}ms</span>
                      </div>
                    </div>
                    <button class="btn btn-sm btn-outline-primary" @click="testSpecificServer(server)">
                      Test
                    </button>
                  </div>
                  <button class="btn btn-sm btn-primary mt-2" @click="runMultiServerTest">
                    🚀 Test All Servers
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Speed Test Settings -->
        <div class="speed-test-settings">
          <div class="row">
            <div class="col-md-6">
              <div class="settings-card">
                <h6>⚙️ Test Configuration</h6>
                <div class="form-group mb-3">
                  <label>Test Duration</label>
                  <select class="form-control" v-model="testDuration">
                    <option value="10">Quick (10 seconds)</option>
                    <option value="30">Standard (30 seconds)</option>
                    <option value="60">Thorough (60 seconds)</option>
                  </select>
                </div>
                <div class="form-group mb-3">
                  <label>Test Type</label>
                  <select class="form-control" v-model="testType">
                    <option value="comprehensive">Comprehensive</option>
                    <option value="download">Download Only</option>
                    <option value="upload">Upload Only</option>
                    <option value="ping">Ping Only</option>
                  </select>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" v-model="autoSaveResults" id="autoSave">
                  <label class="form-check-label" for="autoSave">
                    Auto-save results to history
                  </label>
                </div>
              </div>
            </div>
            
            <div class="col-md-6">
              <div class="settings-card">
                <h6>📊 Performance Insights</h6>
                <div class="insights" v-if="speedTestResults">
                  <div class="insight-item">
                    <div class="insight-icon">🎮</div>
                    <div class="insight-text">
                      <strong>Gaming:</strong> {{ getGamingRating() }}
                    </div>
                  </div>
                  <div class="insight-item">
                    <div class="insight-icon">📺</div>
                    <div class="insight-text">
                      <strong>4K Streaming:</strong> {{ getStreamingRating() }}
                    </div>
                  </div>
                  <div class="insight-item">
                    <div class="insight-icon">💼</div>
                    <div class="insight-text">
                      <strong>Video Calls:</strong> {{ getVideoCallRating() }}
                    </div>
                  </div>
                  <div class="insight-item">
                    <div class="insight-icon">☁️</div>
                    <div class="insight-text">
                      <strong>Cloud Backup:</strong> {{ getCloudRating() }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Security Features -->
      <div v-else-if="page === 'security'">
        <h2>🛡️ Advanced Security</h2>
        <div class="row">
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>🚨 Kill Switch</h5>
              </div>
              <div class="card-body">
                <p>Automatically disconnect internet if VPN connection drops</p>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" v-model="securitySettings.killSwitch" id="killSwitch">
                  <label class="form-check-label" for="killSwitch">Enable Kill Switch</label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>🔀 Split Tunneling</h5>
              </div>
              <div class="card-body">
                <p>Choose which apps use VPN connection</p>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" v-model="securitySettings.splitTunneling" id="splitTunneling">
                  <label class="form-check-label" for="splitTunneling">Enable Split Tunneling</label>
                </div>
                <div v-if="securitySettings.splitTunneling" class="mt-3">
                  <textarea class="form-control" v-model="securitySettings.splitApps" placeholder="Enter app names (one per line)"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="row mt-4">
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>🛡️ DNS Leak Protection</h5>
              </div>
              <div class="card-body">
                <p>Prevent DNS requests from leaking outside VPN tunnel</p>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" v-model="securitySettings.dnsProtection" id="dnsProtection">
                  <label class="form-check-label" for="dnsProtection">Enable DNS Protection</label>
                </div>
                <button class="btn btn-outline-primary mt-2" @click="testDNSLeak">Test DNS Leak</button>
                <div v-if="dnsLeakResult" class="mt-2">
                  <span :class="dnsLeakResult.safe ? 'text-success' : 'text-danger'">
                    {{ dnsLeakResult.message }}
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>🚫 Ad Blocker</h5>
              </div>
              <div class="card-body">
                <p>Block ads, trackers, and malicious websites</p>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" v-model="securitySettings.adBlocker" id="adBlocker">
                  <label class="form-check-label" for="adBlocker">Enable Ad Blocker</label>
                </div>
                <div class="mt-2">
                  <small class="text-muted">Blocked today: {{ adsBlocked }} ads</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Professional Servers Page -->
      <div v-else-if="page === 'servers'">
        <!-- Server Dashboard Header -->
        <div class="server-dashboard-header mb-4">
          <div class="row">
            <div class="col-md-8">
              <h2 class="mb-2">🌍 Global Server Network</h2>
              <p class="text-muted">Connect to our premium servers worldwide for optimal performance and security</p>
            </div>
            <div class="col-md-4 text-end">
              <div class="server-status-indicator">
                <span class="status-dot status-online"></span>
                <span class="small">All Systems Operational</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Server Statistics Dashboard -->
        <div class="row mb-4">
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-icon">🌐</div>
              <div class="stat-value">{{ totalServers }}</div>
              <div class="stat-label">Total Servers</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-icon">🌍</div>
              <div class="stat-value">{{ totalCountries }}</div>
              <div class="stat-label">Countries</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-icon">⚡</div>
              <div class="stat-value">{{ networkStats.avgSpeed }} Mbps</div>
              <div class="stat-label">Avg Speed</div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="stat-card">
              <div class="stat-icon">👥</div>
              <div class="stat-value">{{ networkStats.activeConnections.toLocaleString() }}</div>
              <div class="stat-label">Active Users</div>
            </div>
          </div>
        </div>

        <!-- Advanced Search and Filters -->
        <div class="server-filters mb-4">
          <div class="row">
            <div class="col-md-4">
              <div class="search-box">
                <input type="text" class="form-control" v-model="serverSearch" placeholder="🔍 Search by city, country, or provider...">
              </div>
            </div>
            <div class="col-md-2">
              <select class="form-control" v-model="serverFilter">
                <option value="">All Regions</option>
                <option value="Americas">🌎 Americas</option>
                <option value="Europe">🌍 Europe</option>
                <option value="Asia">🌏 Asia-Pacific</option>
                <option value="Africa">🌍 Africa</option>
              </select>
            </div>
            <div class="col-md-2">
              <select class="form-control" v-model="speedFilter">
                <option value="">All Speeds</option>
                <option value="high">⚡ 1 Gbps+</option>
                <option value="medium">🚀 500 Mbps+</option>
                <option value="standard">📶 All Speeds</option>
              </select>
            </div>
            <div class="col-md-2">
              <select class="form-control" v-model="loadFilter">
                <option value="">All Loads</option>
                <option value="low">🟢 Low Load (< 30%)</option>
                <option value="medium">🟡 Medium Load (30-60%)</option>
                <option value="high">🟠 High Load (60%+)</option>
              </select>
            </div>
            <div class="col-md-2">
              <select class="form-control" v-model="featureFilter">
                <option value="">All Features</option>
                <option value="p2p">📡 P2P Optimized</option>
                <option value="ipv6">🌐 IPv6 Support</option>
                <option value="premium">⭐ Premium Only</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="server-actions mb-4">
          <div class="row">
            <div class="col-md-8">
              <button class="btn btn-primary me-2" @click="autoConnectBest">
                <i class="fas fa-bolt"></i> Auto-Connect Best Server
              </button>
              <button class="btn btn-outline-success me-2" @click="refreshServers">
                <i class="fas fa-sync-alt"></i> Refresh All Servers
              </button>
              <button class="btn btn-outline-info me-2" @click="showFavorites = !showFavorites">
                <i class="fas fa-star"></i> {{ showFavorites ? 'Show All Servers' : 'Show Favorites Only' }}
              </button>
              <button class="btn btn-outline-secondary me-2" @click="showServerComparison = !showServerComparison">
                <i class="fas fa-balance-scale"></i> Compare Servers
              </button>
            </div>
            <div class="col-md-4 text-end">
              <div class="view-toggle">
                <button class="btn btn-sm" :class="viewMode === 'grid' ? 'btn-primary' : 'btn-outline-primary'" @click="viewMode = 'grid'">
                  <i class="fas fa-th"></i> Grid
                </button>
                <button class="btn btn-sm" :class="viewMode === 'list' ? 'btn-primary' : 'btn-outline-primary'" @click="viewMode = 'list'">
                  <i class="fas fa-list"></i> List
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Server Comparison Panel -->
        <div v-if="showServerComparison" class="server-comparison-panel mb-4">
          <div class="card">
            <div class="card-header">
              <h5><i class="fas fa-balance-scale"></i> Server Comparison</h5>
            </div>
            <div class="card-body">
              <p class="text-muted">Select servers below to compare their specifications</p>
              <div class="row" v-if="comparisonServers.length > 0">
                <div class="col-md-4" v-for="server in comparisonServers" :key="'compare-' + server.id">
                  <div class="comparison-card">
                    <h6>{{ server.flag }} {{ server.location }}</h6>
                    <ul class="list-unstyled small">
                      <li><strong>Ping:</strong> {{ server.ping }}ms</li>
                      <li><strong>Load:</strong> {{ server.load }}%</li>
                      <li><strong>Speed:</strong> {{ server.bandwidth }}</li>
                      <li><strong>Provider:</strong> {{ server.provider }}</li>
                      <li><strong>P2P:</strong> {{ server.p2p ? '✅' : '❌' }}</li>
                      <li><strong>IPv6:</strong> {{ server.ipv6 ? '✅' : '❌' }}</li>
                    </ul>
                    <button class="btn btn-sm btn-outline-danger" @click="removeFromComparison(server)">Remove</button>
                  </div>
                </div>
              </div>
              <div v-else class="text-center text-muted">
                <p>No servers selected for comparison</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Servers Grid/List View -->
        <div class="servers-container">
          <div v-if="viewMode === 'grid'" class="row">
            <div class="col-lg-4 col-md-6 mb-4" v-for="server in filteredServers" :key="server.id">
              <div class="server-card" 
                   :class="{ 
                     'server-connected': connectedServer?.id === server.id,
                     'server-premium': server.favorite,
                     'server-selected': comparisonServers.includes(server)
                   }">
                <div class="server-card-header">
                  <div class="d-flex justify-content-between align-items-start">
                    <div>
                      <h5 class="server-title">
                        <span class="flag-icon">{{ server.flag }}</span>
                        {{ server.location }}
                        <span v-if="server.favorite" class="premium-badge">⭐</span>
                      </h5>
                      <p class="server-subtitle text-muted">{{ server.cities }} cities • {{ server.region }}</p>
                    </div>
                    <div class="server-status" :class="getServerStatusClass(server)">
                      <div class="status-dot"></div>
                    </div>
                  </div>
                </div>
                
                <div class="server-card-body">
                  <!-- Performance Metrics -->
                  <div class="performance-metrics mb-3">
                    <div class="metric">
                      <div class="metric-label">Ping</div>
                      <div class="metric-value" :class="getPingClass(server.ping)">{{ server.ping }}ms</div>
                    </div>
                    <div class="metric">
                      <div class="metric-label">Load</div>
                      <div class="metric-value">
                        <div class="load-bar-container">
                          <div class="load-bar" :class="getLoadClass(server.load)" :style="{ width: server.load + '%' }"></div>
                        </div>
                        <span class="load-text">{{ server.load }}%</span>
                      </div>
                    </div>
                    <div class="metric">
                      <div class="metric-label">Speed</div>
                      <div class="metric-value">{{ server.bandwidth }}</div>
                    </div>
                  </div>

                  <!-- Server Details -->
                  <div class="server-details mb-3">
                    <div class="detail-row">
                      <span class="detail-label">Provider:</span>
                      <span class="detail-value">{{ server.provider }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Datacenter:</span>
                      <span class="detail-value">{{ server.datacenter }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Timezone:</span>
                      <span class="detail-value">{{ server.timezone }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Uptime:</span>
                      <span class="detail-value uptime-good">{{ server.uptime }}%</span>
                    </div>
                  </div>

                  <!-- Features -->
                  <div class="server-features mb-3">
                    <span class="feature-badge" :class="server.p2p ? 'feature-enabled' : 'feature-disabled'">
                      {{ server.p2p ? '✅' : '❌' }} P2P
                    </span>
                    <span class="feature-badge" :class="server.ipv6 ? 'feature-enabled' : 'feature-disabled'">
                      {{ server.ipv6 ? '✅' : '❌' }} IPv6
                    </span>
                    <span class="feature-badge feature-enabled">
                      🔒 AES-256
                    </span>
                  </div>

                  <!-- User Stats -->
                  <div class="user-stats mb-3">
                    <span class="stats-item">
                      <i class="fas fa-users"></i> {{ server.users.toLocaleString() }} users
                    </span>
                    <span class="stats-item">
                      <i class="fas fa-signal"></i> {{ server.maxSpeed }} Mbps max
                    </span>
                  </div>
                </div>

                <div class="server-card-footer">
                  <div class="server-actions">
                    <button class="btn btn-primary flex-fill me-2" 
                            :class="connectedServer?.id === server.id ? 'btn-danger' : 'btn-primary'"
                            @click="toggleConnection(server)">
                      {{ connectedServer?.id === server.id ? '🔓 Disconnect' : '🔗 Connect' }}
                    </button>
                    <button class="btn btn-outline-secondary me-2" @click="toggleFavorite(server)">
                      {{ server.favorite ? '⭐' : '☆' }}
                    </button>
                    <button class="btn btn-outline-info me-2" @click="showServerDetails(server)">
                      <i class="fas fa-info-circle"></i>
                    </button>
                    <button class="btn btn-outline-warning" @click="toggleServerComparison(server)">
                      <i class="fas fa-balance-scale"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- List View -->
          <div v-else class="server-list">
            <div class="server-list-item" 
                 v-for="server in filteredServers" 
                 :key="server.id"
                 :class="{ 
                   'server-connected': connectedServer?.id === server.id,
                   'server-premium': server.favorite,
                   'server-selected': comparisonServers.includes(server)
                 }">
              <div class="row align-items-center">
                <div class="col-md-4">
                  <div class="server-info">
                    <h6 class="mb-1">
                      <span class="flag-icon me-2">{{ server.flag }}</span>
                      {{ server.location }}
                      <span v-if="server.favorite" class="premium-badge ms-2">⭐</span>
                    </h6>
                    <p class="text-muted small mb-0">{{ server.cities }} cities • {{ server.provider }}</p>
                  </div>
                </div>
                <div class="col-md-2 text-center">
                  <div class="performance-indicator">
                    <div class="ping-indicator" :class="getPingClass(server.ping)">{{ server.ping }}ms</div>
                    <div class="small text-muted">Ping</div>
                  </div>
                </div>
                <div class="col-md-2 text-center">
                  <div class="load-indicator">
                    <div class="load-bar-mini">
                      <div class="load-bar" :class="getLoadClass(server.load)" :style="{ width: server.load + '%' }"></div>
                    </div>
                    <div class="small text-muted">{{ server.load }}% Load</div>
                  </div>
                </div>
                <div class="col-md-2 text-center">
                  <div class="features-mini">
                    <span class="feature-mini" :class="server.p2p ? 'text-success' : 'text-muted'">P2P</span>
                    <span class="feature-mini" :class="server.ipv6 ? 'text-success' : 'text-muted'">IPv6</span>
                  </div>
                </div>
                <div class="col-md-2 text-end">
                  <div class="server-actions-mini">
                    <button class="btn btn-sm me-1" 
                            :class="connectedServer?.id === server.id ? 'btn-danger' : 'btn-primary'"
                            @click="toggleConnection(server)">
                      {{ connectedServer?.id === server.id ? 'Disconnect' : 'Connect' }}
                    </button>
                    <button class="btn btn-sm btn-outline-secondary me-1" @click="toggleFavorite(server)">
                      {{ server.favorite ? '⭐' : '☆' }}
                    </button>
                    <button class="btn btn-sm btn-outline-info" @click="showServerDetails(server)">
                      <i class="fas fa-info"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Results -->
        <div v-if="filteredServers.length === 0" class="no-results text-center py-5">
          <i class="fas fa-search fa-3x text-muted mb-3"></i>
          <h5>No servers found</h5>
          <p class="text-muted">Try adjusting your search criteria or filters</p>
          <button class="btn btn-outline-primary" @click="clearAllFilters">Clear All Filters</button>
        </div>
      </div>

      <!-- Pricing -->
      <div v-else-if="page === 'pricing'">
        <h2>Choose Your Plan</h2>
        <div class="row">
          <div class="col-md-4" v-for="plan in plans" :key="plan.name">
            <div class="card h-100">
              <div class="card-header bg-dark text-white">
                <h5>{{ plan.name }}</h5>
              </div>
              <div class="card-body">
                <h2>${{ plan.price }}<small>/mo</small></h2>
                <ul class="list-unstyled">
                  <li v-for="f in plan.features" :key="f">✓ {{ f }}</li>
                </ul>
                <button class="btn btn-fbiv w-100" @click="selectPlan(plan)">
                  {{ isLoggedIn ? 'Subscribe' : 'Join First' }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Account -->
      <div v-else-if="page === 'account' && isLoggedIn">
        <h2>Account Settings</h2>
        <form @submit.prevent="saveAccount" class="mt-3">
          <div class="mb-3">
            <label class="form-label">Full Name</label>
            <input v-model="profile.name" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input v-model="profile.email" class="form-control" disabled />
          </div>
          <div class="mb-3">
            <label class="form-label">Date of Birth</label>
            <input v-model="profile.dob" type="date" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Payment Method</label>
            <select v-model="profile.payment" class="form-control">
              <option value="paypal">PayPal</option>
              <option value="btc">Bitcoin (BTC)</option>
              <option value="eth">Ethereum (ETH)</option>
            </select>
          </div>
          <button type="submit" class="btn btn-fbiv" @click="saveAccount">Save Settings</button>
        </form>
      </div>

      <!-- Payment Modal -->
      <div v-if="showPaymentModal" class="modal-backdrop"></div>
      <div v-if="showPaymentModal" class="modal d-block">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Complete Payment</h5>
              <button type="button" class="btn-close" @click="showPaymentModal=false" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <h5>{{ selectedPlan.name }} Plan - ${{ selectedPlan.price }}/mo</h5>

              <div v-if="profile.payment === 'paypal'">
                <div class="alert alert-info">
                  <strong>PayPal Payment</strong>
                  <p>This would redirect to PayPal in a real implementation.</p>
                  <button class="btn btn-success" @click="simulatePayment">Simulate Payment</button>
                </div>
              </div>

              <div v-else-if="profile.payment === 'btc'">
                <div class="alert alert-warning">
                  <strong>Bitcoin Payment</strong>
                  <p>Send 0.0005 BTC to: bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq</p>
                  <button class="btn btn-primary" @click="simulatePayment">Simulate Payment</button>
                </div>
              </div>

              <div v-else>
                <div class="alert alert-secondary">
                  <p>Crypto payment option selected.</p>
                  <button class="btn btn-success" @click="simulatePayment">Simulate Payment</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Login Modal -->
    <div v-if="showModal==='login'" class="modal-backdrop"></div>
    <div v-if="showModal==='login'" class="modal d-block">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Login to FBIV VPN</h5>
            <button type="button" class="btn-close" @click="showModal=null" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form @submit.prevent="login">
              <input v-model="auth.email" placeholder="Email" type="email" class="form-control mb-2" required />
              <input v-model="auth.password" type="password" placeholder="Password" class="form-control mb-2" required />
              <button type="submit" class="btn btn-fbiv w-100 mt-2">Login</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Register Modal -->
    <div v-if="showModal==='register'" class="modal-backdrop"></div>
    <div v-if="showModal==='register'" class="modal d-block">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Join FBIV VPN</h5>
            <button type="button" class="btn-close" @click="showModal=null" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form @submit.prevent="register">
              <input v-model="auth.name" placeholder="Full Name" type="text" class="form-control mb-2" required />
              <input v-model="auth.email" placeholder="Email" type="email" class="form-control mb-2" required />
              <input v-model="auth.dob" type="date" class="form-control mb-2" required />
              <input v-model="auth.password" type="password" placeholder="Password" class="form-control mb-2" required minlength="6" />
              <button type="submit" class="btn btn-fbiv w-100 mt-2">Create Account</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <p>© 2025 FBIV VPN. All rights reserved.</p>
      <p>Secure. Private. Invisible.</p>
    </footer>

    <!-- Server Details Modal -->
    <div v-if="selectedServerDetails" class="server-details-modal" @click.self="closeServerDetails">
      <div class="server-details-content">
        <!-- Compact Header -->
        <div class="server-header">
          <div class="server-flag">{{ selectedServerDetails.flag }}</div>
          <div class="server-title">
            <h3>{{ selectedServerDetails.location }}</h3>
            <div class="server-status">
              <span v-if="connectedServer?.id === selectedServerDetails.id" class="text-success">
                🔒 Connected • {{ getConnectionTime() }}
              </span>
              <span v-else class="text-muted">
                🔓 Available • {{ selectedServerDetails.users }} users online
              </span>
            </div>
          </div>
          <button type="button" class="btn-close" @click="closeServerDetails" aria-label="Close"></button>
        </div>

        <!-- Two-Column Layout -->
        <div class="server-modal-body">
          <!-- Left Column: Performance & Stats -->
          <div class="left-column">
            <div class="section">
              <h5>📊 Performance Metrics</h5>
              <div class="compact-stats">
                <div class="stat-item">
                  <div class="stat-value" :class="getPingClass(selectedServerDetails.ping)">{{ selectedServerDetails.ping }}ms</div>
                  <div class="stat-label">Latency</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value" :class="getLoadClass(selectedServerDetails.load)">{{ selectedServerDetails.load }}%</div>
                  <div class="stat-label">Load</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">{{ selectedServerDetails.bandwidth }}</div>
                  <div class="stat-label">Bandwidth</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">{{ selectedServerDetails.uptime }}%</div>
                  <div class="stat-label">Uptime</div>
                </div>
              </div>
            </div>

            <div class="section">
              <h5>🌐 Server Information</h5>
              <div class="info-grid">
                <div class="info-item">
                  <span class="info-label">Region:</span>
                  <span class="info-value">{{ selectedServerDetails.region }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Provider:</span>
                  <span class="info-value">{{ selectedServerDetails.provider }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Datacenter:</span>
                  <span class="info-value">{{ selectedServerDetails.datacenter }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Timezone:</span>
                  <span class="info-value">{{ selectedServerDetails.timezone }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Cities:</span>
                  <span class="info-value">{{ selectedServerDetails.cities }} locations</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Max Speed:</span>
                  <span class="info-value">{{ selectedServerDetails.maxSpeed }} Mbps</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column: Features & Actions -->
          <div class="right-column">
            <div class="section">
              <h5>⚡ Features & Capabilities</h5>
              <div class="features-compact">
                <div class="feature-compact" :class="selectedServerDetails.ipv6 ? 'feature-enabled' : 'feature-disabled'">
                  <span class="feature-icon">🌐</span>
                  <span class="feature-text">IPv6 Support</span>
                  <span class="feature-status">{{ selectedServerDetails.ipv6 ? '✅' : '❌' }}</span>
                </div>
                <div class="feature-compact" :class="selectedServerDetails.p2p ? 'feature-enabled' : 'feature-disabled'">
                  <span class="feature-icon">📡</span>
                  <span class="feature-text">P2P/Torrenting</span>
                  <span class="feature-status">{{ selectedServerDetails.p2p ? '✅' : '❌' }}</span>
                </div>
                <div class="feature-compact feature-enabled">
                  <span class="feature-icon">🔒</span>
                  <span class="feature-text">AES-256 Encryption</span>
                  <span class="feature-status">✅</span>
                </div>
                <div class="feature-compact feature-enabled">
                  <span class="feature-icon">🛡️</span>
                  <span class="feature-text">DDoS Protection</span>
                  <span class="feature-status">✅</span>
                </div>
                <div class="feature-compact feature-enabled">
                  <span class="feature-icon">🚫</span>
                  <span class="feature-text">No-Logs Policy</span>
                  <span class="feature-status">✅</span>
                </div>
                <div class="feature-compact feature-enabled">
                  <span class="feature-icon">⚡</span>
                  <span class="feature-text">Kill Switch</span>
                  <span class="feature-status">✅</span>
                </div>
              </div>
            </div>

            <div class="section">
              <h5>🔧 Quick Actions</h5>
              <div class="connection-buttons-compact">
                <button 
                  v-if="connectedServer?.id !== selectedServerDetails.id"
                  @click="connectToServerFromModal(selectedServerDetails)" 
                  class="btn btn-primary btn-block">
                  🔒 Connect to Server
                </button>
                <button 
                  v-else
                  @click="disconnect" 
                  class="btn btn-danger btn-block">
                  🔓 Disconnect
                </button>
                
                <div class="action-buttons-row">
                  <button @click="toggleFavorite(selectedServerDetails)" class="btn btn-outline-warning">
                    {{ selectedServerDetails.favorite ? '⭐' : '☆' }} Favorite
                  </button>
                  <button @click="testServerSpeed" class="btn btn-outline-info">
                    ⚡ Speed Test
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script>
    const { createApp, ref, onMounted, computed } = Vue;

  // 🔥 Firebase Configuration (REPLACE WITH YOUR CONFIG)
  const firebaseConfig = {
    apiKey: "AIzaSyD2tSH-ZKj6HorJCJIZ0q9hf_fY_nT5PVc",
    authDomain: "fbi-vpn.firebaseapp.com",
    projectId: "fbi-vpn",
    storageBucket: "fbi-vpn.firebasestorage.app",
    messagingSenderId: "724938549842",
    appId: "1:724938549842:web:cc92681b2a615cf1fe0d8b",
    measurementId: "G-31P4GRNEW5"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const firebaseAuth = firebase.auth();
  const db = firebase.firestore();

  createApp({
    setup() {
      const page = ref('home');
      const isLoggedIn = ref(false);
      const showModal = ref(null);
      const showPaymentModal = ref(false);
      const selectedPlan = ref(null);
      const auth = ref({ email: '', password: '', name: '', dob: '' });
      const profile = ref({ name: '', email: '', dob: '', payment: 'paypal' });

      // Theme and UI State
      const isDarkTheme = ref(false);
      const connectionStatus = ref('disconnected'); // connected, connecting, disconnected
      const connectedServer = ref(null);
      const isLoading = ref(false);
      const loadingText = ref('Loading FBIV VPN...');
      
      // Server Management
      const serverSearch = ref('');
      const serverFilter = ref('');
      const speedFilter = ref('');
      const loadFilter = ref('');
      const featureFilter = ref('');
      const showFavorites = ref(false);
      const selectedServerDetails = ref(null);
      const viewMode = ref('grid');
      const showServerComparison = ref(false);
      const comparisonServers = ref([]);
      
      // Analytics and Monitoring
      const dataUsage = ref(2.5);
      const connectionTime = ref('2h 15m');
      const downloadSpeed = ref(85.4);
      const uploadSpeed = ref(23.1);
      const connectionHistory = ref([
        { id: 1, server: 'New York, USA', date: '2025-09-29 14:30', duration: '2h 15m' },
        { id: 2, server: 'Frankfurt, Germany', date: '2025-09-28 16:45', duration: '45m' },
        { id: 3, server: 'Tokyo, Japan', date: '2025-09-28 09:20', duration: '1h 30m' }
      ]);

      // Speed Test
      const speedTesting = ref(false);
      const lastSpeedTest = ref(null);
      const speedTestResults = ref(null);
      const currentTestSpeed = ref(0);
      const currentDownloadSpeed = ref(0);
      const currentUploadSpeed = ref(0);
      const currentPing = ref(0);
      const currentJitter = ref(0);
      const testingPhase = ref('Initializing...');
      const testDuration = ref(30);
      const testType = ref('comprehensive');
      const autoSaveResults = ref(true);
      const speedHistory = ref([
        { time: '10:30 AM', download: '85.4', upload: '23.1', ping: '12' },
        { time: '09:15 AM', download: '92.7', upload: '28.5', ping: '15' },
        { time: '08:45 AM', download: '78.9', upload: '21.3', ping: '18' }
      ]);
      const diagnosticRunning = ref(false);
      const diagnosticResults = ref(null);
      const topPerformingServers = ref([
        { id: 1, flag: '🇺🇸', location: 'New York', avgSpeed: 950, ping: 12 },
        { id: 2, flag: '🇬🇧', location: 'London', avgSpeed: 920, ping: 8 },
        { id: 3, flag: '🇩🇪', location: 'Frankfurt', avgSpeed: 890, ping: 9 }
      ]);

      // Security Settings
      const securitySettings = ref({
        killSwitch: true,
        splitTunneling: false,
        splitApps: '',
        dnsProtection: true,
        adBlocker: true
      });
      const dnsLeakResult = ref(null);
      const adsBlocked = ref(1247);

      // Home Page Data
      const totalUsers = ref(2847392);
      const totalServers = ref(520);
      const totalCountries = ref(60);
      const openFaqs = ref([]);
      
      const networkStats = ref({
        avgSpeed: 85.4,
        globalLoad: 34,
        activeConnections: 847392,
        dataProtected: 2847
      });

      const faqs = ref([
        {
          question: "How does FBIV VPN protect my privacy?",
          answer: "We use military-grade AES-256 encryption and maintain a strict no-logs policy. Your data is never stored, tracked, or shared with anyone."
        },
        {
          question: "Can I use FBIV VPN for streaming?",
          answer: "Absolutely! Our servers are optimized for streaming services like Netflix, Disney+, and more. Enjoy 4K content without buffering."
        },
        {
          question: "How many devices can I connect?",
          answer: "Depending on your plan, you can connect 1-10 devices simultaneously. All your devices stay protected under one account."
        },
        {
          question: "Do you offer a money-back guarantee?",
          answer: "Yes! We offer a 30-day money-back guarantee. If you're not satisfied, get a full refund, no questions asked."
        },
        {
          question: "Is FBIV VPN legal to use?",
          answer: "VPNs are legal in most countries. However, please ensure compliance with local laws in your jurisdiction."
        }
      ]);

      // Enhanced Servers Data
      const servers = ref([
        { 
          id: 1, location: 'New York, USA', cities: 12, ping: 18, flag: '🇺🇸', 
          load: 35, users: 1250, favorite: false, region: 'Americas',
          bandwidth: '1 Gbps', maxSpeed: 950, uptime: 99.9,
          timezone: 'EST (UTC-5)', provider: 'AWS', datacenter: 'US-East-1',
          ipv6: true, p2p: true
        },
        { 
          id: 2, location: 'Frankfurt, Germany', cities: 8, ping: 42, flag: '🇩🇪', 
          load: 58, users: 890, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 920, uptime: 99.8,
          timezone: 'CET (UTC+1)', provider: 'Digital Ocean', datacenter: 'EU-Central-1',
          ipv6: true, p2p: true
        },
        { 
          id: 3, location: 'Tokyo, Japan', cities: 6, ping: 68, flag: '🇯🇵', 
          load: 23, users: 765, favorite: false, region: 'Asia',
          bandwidth: '500 Mbps', maxSpeed: 480, uptime: 99.7,
          timezone: 'JST (UTC+9)', provider: 'Google Cloud', datacenter: 'Asia-Northeast-1',
          ipv6: true, p2p: false
        },
        { 
          id: 4, location: 'São Paulo, Brazil', cities: 3, ping: 110, flag: '🇧🇷', 
          load: 67, users: 432, favorite: false, region: 'Americas',
          bandwidth: '500 Mbps', maxSpeed: 450, uptime: 99.5,
          timezone: 'BRT (UTC-3)', provider: 'Azure', datacenter: 'Brazil-South',
          ipv6: false, p2p: true
        },
        { 
          id: 5, location: 'London, UK', cities: 15, ping: 28, flag: '🇬🇧', 
          load: 41, users: 1180, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 980, uptime: 99.9,
          timezone: 'GMT (UTC+0)', provider: 'AWS', datacenter: 'EU-West-2',
          ipv6: true, p2p: true
        },
        { 
          id: 6, location: 'Sydney, Australia', cities: 4, ping: 95, flag: '🇦🇺', 
          load: 29, users: 623, favorite: false, region: 'Asia',
          bandwidth: '500 Mbps', maxSpeed: 470, uptime: 99.6,
          timezone: 'AEDT (UTC+11)', provider: 'AWS', datacenter: 'AP-Southeast-2',
          ipv6: true, p2p: true
        },
        { 
          id: 7, location: 'Toronto, Canada', cities: 7, ping: 22, flag: '🇨🇦', 
          load: 52, users: 987, favorite: false, region: 'Americas',
          bandwidth: '1 Gbps', maxSpeed: 900, uptime: 99.8,
          timezone: 'EST (UTC-5)', provider: 'Digital Ocean', datacenter: 'Canada-Central',
          ipv6: true, p2p: true
        },
        { 
          id: 8, location: 'Amsterdam, Netherlands', cities: 5, ping: 38, flag: '🇳🇱', 
          load: 33, users: 1056, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 940, uptime: 99.9,
          timezone: 'CET (UTC+1)', provider: 'Google Cloud', datacenter: 'EU-West-4',
          ipv6: true, p2p: true
        },
        { 
          id: 9, location: 'Singapore', cities: 3, ping: 45, flag: '🇸🇬', 
          load: 28, users: 1342, favorite: false, region: 'Asia',
          bandwidth: '1 Gbps', maxSpeed: 950, uptime: 99.8,
          timezone: 'SGT (UTC+8)', provider: 'AWS', datacenter: 'AP-Southeast-1',
          ipv6: true, p2p: true
        },
        { 
          id: 10, location: 'Mumbai, India', cities: 9, ping: 52, flag: '🇮🇳', 
          load: 61, users: 2134, favorite: false, region: 'Asia',
          bandwidth: '500 Mbps', maxSpeed: 480, uptime: 99.6,
          timezone: 'IST (UTC+5:30)', provider: 'Google Cloud', datacenter: 'Asia-South-1',
          ipv6: true, p2p: false
        },
        { 
          id: 11, location: 'Paris, France', cities: 12, ping: 31, flag: '🇫🇷', 
          load: 45, users: 1567, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 920, uptime: 99.9,
          timezone: 'CET (UTC+1)', provider: 'AWS', datacenter: 'EU-West-3',
          ipv6: true, p2p: true
        },
        { 
          id: 12, location: 'Los Angeles, USA', cities: 8, ping: 25, flag: '🇺🇸', 
          load: 39, users: 1789, favorite: false, region: 'Americas',
          bandwidth: '1 Gbps', maxSpeed: 960, uptime: 99.7,
          timezone: 'PST (UTC-8)', provider: 'Digital Ocean', datacenter: 'US-West-1',
          ipv6: true, p2p: true
        },
        { 
          id: 13, location: 'Seoul, South Korea', cities: 4, ping: 58, flag: '🇰🇷', 
          load: 34, users: 876, favorite: false, region: 'Asia',
          bandwidth: '1 Gbps', maxSpeed: 890, uptime: 99.8,
          timezone: 'KST (UTC+9)', provider: 'Azure', datacenter: 'Korea-Central',
          ipv6: true, p2p: true
        },
        { 
          id: 14, location: 'Milan, Italy', cities: 6, ping: 41, flag: '🇮🇹', 
          load: 53, users: 1203, favorite: false, region: 'Europe',
          bandwidth: '500 Mbps', maxSpeed: 470, uptime: 99.5,
          timezone: 'CET (UTC+1)', provider: 'Google Cloud', datacenter: 'EU-West-8',
          ipv6: true, p2p: true
        },
        { 
          id: 15, location: 'Stockholm, Sweden', cities: 2, ping: 29, flag: '🇸🇪', 
          load: 21, users: 634, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 980, uptime: 99.9,
          timezone: 'CET (UTC+1)', provider: 'AWS', datacenter: 'EU-North-1',
          ipv6: true, p2p: true
        },
        { 
          id: 16, location: 'Hong Kong', cities: 5, ping: 61, flag: '🇭🇰', 
          load: 47, users: 1456, favorite: false, region: 'Asia',
          bandwidth: '1 Gbps', maxSpeed: 910, uptime: 99.7,
          timezone: 'HKT (UTC+8)', provider: 'Google Cloud', datacenter: 'Asia-East-2',
          ipv6: true, p2p: false
        },
        { 
          id: 17, location: 'Dubai, UAE', cities: 3, ping: 73, flag: '🇦🇪', 
          load: 56, users: 987, favorite: false, region: 'Asia',
          bandwidth: '500 Mbps', maxSpeed: 460, uptime: 99.4,
          timezone: 'GST (UTC+4)', provider: 'Azure', datacenter: 'UAE-North',
          ipv6: true, p2p: true
        },
        { 
          id: 18, location: 'Mexico City, Mexico', cities: 4, ping: 87, flag: '🇲🇽', 
          load: 62, users: 723, favorite: false, region: 'Americas',
          bandwidth: '500 Mbps', maxSpeed: 450, uptime: 99.3,
          timezone: 'CST (UTC-6)', provider: 'Digital Ocean', datacenter: 'Mexico-Central',
          ipv6: false, p2p: true
        },
        { 
          id: 19, location: 'Zurich, Switzerland', cities: 2, ping: 34, flag: '🇨🇭', 
          load: 26, users: 567, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 970, uptime: 99.9,
          timezone: 'CET (UTC+1)', provider: 'AWS', datacenter: 'EU-Central-2',
          ipv6: true, p2p: true
        },
        { 
          id: 20, location: 'Cape Town, South Africa', cities: 2, ping: 125, flag: '🇿🇦', 
          load: 43, users: 456, favorite: false, region: 'Africa',
          bandwidth: '300 Mbps', maxSpeed: 280, uptime: 99.2,
          timezone: 'SAST (UTC+2)', provider: 'Azure', datacenter: 'South-Africa-North',
          ipv6: false, p2p: true
        },
        { 
          id: 21, location: 'Moscow, Russia', cities: 7, ping: 76, flag: '🇷🇺', 
          load: 58, users: 1245, favorite: false, region: 'Europe',
          bandwidth: '500 Mbps', maxSpeed: 480, uptime: 99.1,
          timezone: 'MSK (UTC+3)', provider: 'Yandex Cloud', datacenter: 'Russia-Central',
          ipv6: false, p2p: false
        },
        { 
          id: 22, location: 'Chicago, USA', cities: 6, ping: 19, flag: '🇺🇸', 
          load: 37, users: 1534, favorite: false, region: 'Americas',
          bandwidth: '1 Gbps', maxSpeed: 940, uptime: 99.8,
          timezone: 'CST (UTC-6)', provider: 'AWS', datacenter: 'US-Central-1',
          ipv6: true, p2p: true
        },
        { 
          id: 23, location: 'Madrid, Spain', cities: 4, ping: 36, flag: '🇪🇸', 
          load: 49, users: 1089, favorite: false, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 900, uptime: 99.6,
          timezone: 'CET (UTC+1)', provider: 'Digital Ocean', datacenter: 'EU-West-5',
          ipv6: true, p2p: true
        },
        { 
          id: 24, location: 'Vienna, Austria', cities: 2, ping: 33, flag: '🇦🇹', 
          load: 31, users: 723, favorite: false, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 930, uptime: 99.7,
          timezone: 'CET (UTC+1)', provider: 'Google Cloud', datacenter: 'EU-West-6',
          ipv6: true, p2p: true
        },
        { 
          id: 25, location: 'Bangkok, Thailand', cities: 3, ping: 67, flag: '🇹🇭', 
          load: 54, users: 934, favorite: false, region: 'Asia',
          bandwidth: '500 Mbps', maxSpeed: 470, uptime: 99.4,
          timezone: 'ICT (UTC+7)', provider: 'AWS', datacenter: 'AP-Southeast-3',
          ipv6: true, p2p: false
        },
        { 
          id: 26, location: 'Warsaw, Poland', cities: 3, ping: 44, flag: '🇵🇱', 
          load: 41, users: 812, favorite: false, region: 'Europe',
          bandwidth: '500 Mbps', maxSpeed: 480, uptime: 99.5,
          timezone: 'CET (UTC+1)', provider: 'Azure', datacenter: 'Poland-Central',
          ipv6: true, p2p: true
        },
        { 
          id: 27, location: 'Oslo, Norway', cities: 2, ping: 27, flag: '🇳🇴', 
          load: 23, users: 445, favorite: true, region: 'Europe',
          bandwidth: '1 Gbps', maxSpeed: 985, uptime: 99.9,
          timezone: 'CET (UTC+1)', provider: 'AWS', datacenter: 'EU-North-2',
          ipv6: true, p2p: true
        },
        { 
          id: 28, location: 'Buenos Aires, Argentina', cities: 2, ping: 98, flag: '🇦🇷', 
          load: 65, users: 578, favorite: false, region: 'Americas',
          bandwidth: '300 Mbps', maxSpeed: 280, uptime: 99.2,
          timezone: 'ART (UTC-3)', provider: 'Digital Ocean', datacenter: 'South-America-East',
          ipv6: false, p2p: true
        }
      ]);

      const plans = [
        { name: 'Basic', price: 5.99, features: ['1 Device', '500GB Data', '10 Countries', 'Basic Support'] },
        { name: 'Pro', price: 9.99, features: ['5 Devices', 'Unlimited Data', '30 Countries', 'Premium Support', 'Kill Switch'] },
        { name: 'Elite', price: 14.99, features: ['10 Devices', 'Unlimited Data', '60+ Countries', '24/7 Support', 'All Security Features', 'Split Tunneling'] }
      ];

      // Computed Properties
      const connectionStatusClass = computed(() => {
        return {
          'status-connected': connectionStatus.value === 'connected',
          'status-connecting': connectionStatus.value === 'connecting',
          'status-disconnected': connectionStatus.value === 'disconnected'
        };
      });

      const filteredServers = computed(() => {
        let filtered = servers.value;
        
        if (showFavorites.value) {
          filtered = filtered.filter(s => s.favorite);
        }
        
        if (serverSearch.value) {
          const searchTerm = serverSearch.value.toLowerCase();
          filtered = filtered.filter(s => 
            s.location.toLowerCase().includes(searchTerm) ||
            s.provider.toLowerCase().includes(searchTerm) ||
            s.datacenter.toLowerCase().includes(searchTerm)
          );
        }
        
        if (serverFilter.value) {
          filtered = filtered.filter(s => s.region === serverFilter.value);
        }

        if (speedFilter.value) {
          if (speedFilter.value === 'high') {
            filtered = filtered.filter(s => parseInt(s.bandwidth) >= 1000);
          } else if (speedFilter.value === 'medium') {
            filtered = filtered.filter(s => parseInt(s.bandwidth) >= 500);
          }
        }

        if (loadFilter.value) {
          if (loadFilter.value === 'low') {
            filtered = filtered.filter(s => s.load < 30);
          } else if (loadFilter.value === 'medium') {
            filtered = filtered.filter(s => s.load >= 30 && s.load <= 60);
          } else if (loadFilter.value === 'high') {
            filtered = filtered.filter(s => s.load > 60);
          }
        }

        if (featureFilter.value) {
          if (featureFilter.value === 'p2p') {
            filtered = filtered.filter(s => s.p2p);
          } else if (featureFilter.value === 'ipv6') {
            filtered = filtered.filter(s => s.ipv6);
          } else if (featureFilter.value === 'premium') {
            filtered = filtered.filter(s => s.favorite);
          }
        }
        
        return filtered.sort((a, b) => a.ping - b.ping);
      });

      const topServers = computed(() => {
        return servers.value
          .filter(s => s.load < 50)
          .sort((a, b) => a.ping - b.ping)
          .slice(0, 4);
      });

      // Initialize auth state listener
      onMounted(() => {
        firebaseAuth.onAuthStateChanged(async (user) => {
          if (user) {
            isLoggedIn.value = true;
            profile.value.email = user.email;
            await loadProfile(user.uid);
          } else {
            isLoggedIn.value = false;
          }
        });
        
        // Ensure loading is hidden as backup
        setTimeout(() => {
          if (isLoading.value) {
            isLoading.value = false;
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
              overlay.classList.remove('active');
            }
          }
        }, 2000);
      });

      const setPage = (p) => page.value = p;

      const logout = async () => {
        try {
          await firebaseAuth.signOut();
          page.value = 'home';
          alert("✅ You have been logged out.");
        } catch (error) {
          alert("⚠️ Logout failed: " + error.message);
        }
      };

      const login = async () => {
        try {
          const userCredential = await firebaseAuth.signInWithEmailAndPassword(
            auth.value.email,
            auth.value.password
          );
          profile.value.email = userCredential.user.email;
          await loadProfile(userCredential.user.uid);
          showModal.value = null;
          alert("✅ Logged in successfully!");
        } catch (error) {
          alert("⚠️ Login failed: " + error.message);
        }
      };

      const register = async () => {
        try {
          const userCredential = await firebaseAuth.createUserWithEmailAndPassword(
            auth.value.email,
            auth.value.password
          );
          
          // Create user profile
          await db.collection('profiles').doc(userCredential.user.uid).set({
            name: auth.value.name,
            email: auth.value.email,
            dob: auth.value.dob,
            payment: 'paypal',
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
          
          profile.value = {
            name: auth.value.name,
            email: auth.value.email,
            dob: auth.value.dob,
            payment: 'paypal'
          };
          
          showModal.value = null;
          alert("✅ Account created successfully!");
        } catch (error) {
          alert("⚠️ Registration failed: " + error.message);
        }
      };

      const loadProfile = async (uid) => {
        try {
          const doc = await db.collection('profiles').doc(uid).get();
          if (doc.exists) {
            profile.value = { ...profile.value, ...doc.data() };
          }
        } catch (error) {
          console.log("No profile found, using defaults");
        }
      };

      const saveAccount = async () => {
        try {
          const user = firebaseAuth.currentUser;
          if (user) {
            await db.collection('profiles').doc(user.uid).update({
              name: profile.value.name,
              dob: profile.value.dob,
              payment: profile.value.payment,
              updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            alert("✅ Account settings saved!");
          }
        } catch (error) {
          alert("⚠️ Save failed: " + error.message);
        }
      };

      const selectPlan = (plan) => {
        if (!isLoggedIn.value) {
          showModal.value = 'login';
          return;
        }
        selectedPlan.value = plan;
        showPaymentModal.value = true;
      };

      const simulatePayment = () => {
        alert(`✅ Payment successful for ${selectedPlan.value.name} plan!`);
        showPaymentModal.value = false;
      };

      // New Enhanced Methods
      const toggleTheme = () => {
        isDarkTheme.value = !isDarkTheme.value;
        document.documentElement.setAttribute('data-theme', isDarkTheme.value ? 'dark' : 'light');
        localStorage.setItem('theme', isDarkTheme.value ? 'dark' : 'light');
      };

      const connectToServer = async (server) => {
        if (connectionStatus.value === 'connecting') return;
        
        showLoading(`Connecting to ${server.location}...`);
        connectionStatus.value = 'connecting';
        
        // Simulate connection delay
        setTimeout(() => {
          connectedServer.value = server;
          connectionStatus.value = 'connected';
          downloadSpeed.value = Math.random() * 50 + 50; // 50-100 Mbps
          uploadSpeed.value = Math.random() * 20 + 10; // 10-30 Mbps
          
          // Add to connection history
          connectionHistory.value.unshift({
            id: Date.now(),
            server: server.location,
            date: new Date().toLocaleString(),
            duration: 'Active'
          });
          
          hideLoading();
          
          // Trigger confetti celebration!
          setTimeout(() => {
            triggerConnectionCelebration(server.location);
          }, 300);
          
        }, 2000);
      };

      const toggleConnection = (server) => {
        if (connectedServer.value?.id === server.id) {
          disconnect();
        } else {
          connectToServer(server);
        }
      };

      const disconnect = () => {
        connectionStatus.value = 'disconnected';
        connectedServer.value = null;
      };

      const toggleFavorite = (server) => {
        const serverIndex = servers.value.findIndex(s => s.id === server.id);
        if (serverIndex !== -1) {
          servers.value[serverIndex].favorite = !servers.value[serverIndex].favorite;
        }
      };

      const getLoadClass = (load) => {
        if (load < 40) return 'load-low';
        if (load < 70) return 'load-medium';
        return 'load-high';
      };

      const autoConnectBest = () => {
        const bestServer = servers.value
          .filter(s => s.load < 50)
          .sort((a, b) => a.ping - b.ping)[0];
        
        if (bestServer) {
          connectToServer(bestServer);
        }
      };

      const refreshServers = () => {
        // Simulate server refresh with random load updates
        servers.value.forEach(server => {
          server.load = Math.floor(Math.random() * 80) + 10;
          server.ping = server.ping + Math.floor(Math.random() * 10) - 5;
          server.users = Math.floor(Math.random() * 500) + 500;
        });
      };

      const startSpeedTest = async () => {
        speedTesting.value = true;
        speedTestResults.value = null;
        
        // Simulate speed test
        setTimeout(() => {
          speedTestResults.value = {
            download: (Math.random() * 50 + 50).toFixed(1),
            upload: (Math.random() * 20 + 10).toFixed(1),
            ping: Math.floor(Math.random() * 30) + 10
          };
          lastSpeedTest.value = speedTestResults.value.download + ' Mbps';
          speedTesting.value = false;
        }, 3000);
      };

      const testDNSLeak = () => {
        // Simulate DNS leak test
        setTimeout(() => {
          dnsLeakResult.value = {
            safe: Math.random() > 0.2,
            message: Math.random() > 0.2 ? '✅ No DNS leaks detected' : '⚠️ Potential DNS leak detected'
          };
        }, 1000);
      };

      const getLoadColor = (load) => {
        if (load < 40) return '#28a745';
        if (load < 70) return '#ffc107';
        return '#dc3545';
      };

      // Loading Management
      const showLoading = (text = 'Loading...') => {
        isLoading.value = true;
        loadingText.value = text;
        const overlay = document.getElementById('loading-overlay');
        if (overlay) {
          overlay.classList.add('active');
          document.getElementById('loading-text').textContent = text;
        }
      };

      const hideLoading = () => {
        setTimeout(() => {
          isLoading.value = false;
          const overlay = document.getElementById('loading-overlay');
          if (overlay) {
            overlay.classList.remove('active');
          }
        }, 500);
      };

      // Enhanced navigation with loading
      const setPageWithLoading = (pageName) => {
        const pageTexts = {
          home: 'Loading Home...',
          servers: 'Loading Servers...',
          dashboard: 'Loading Dashboard...',
          speedtest: 'Initializing Speed Test...',
          security: 'Loading Security Settings...',
          pricing: 'Loading Plans...',
          account: 'Loading Account...'
        };
        
        showLoading(pageTexts[pageName] || 'Loading...');
        
        setTimeout(() => {
          page.value = pageName;
          hideLoading();
        }, 800);
      };

      // Confetti Animation Functions
      const createConfetti = () => {
        const container = document.getElementById('confetti-container');
        if (!container) return;
        
        const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];
        const shapes = ['circle', 'square', 'triangle'];
        
        for (let i = 0; i < 100; i++) {
          const confetti = document.createElement('div');
          confetti.className = `confetti ${shapes[Math.floor(Math.random() * shapes.length)]}`;
          
          // Random color
          const color = colors[Math.floor(Math.random() * colors.length)];
          if (confetti.classList.contains('triangle')) {
            confetti.style.borderBottomColor = color;
          } else {
            confetti.style.backgroundColor = color;
          }
          
          // Random position and timing
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.animationDelay = Math.random() * 3 + 's';
          confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
          
          container.appendChild(confetti);
        }
        
        // Clean up after animation
        setTimeout(() => {
          container.innerHTML = '';
        }, 5000);
      };

      const showSuccessMessage = (serverName) => {
        const overlay = document.getElementById('success-overlay');
        const message = document.getElementById('success-message');
        
        if (overlay && message) {
          message.textContent = `Successfully connected to ${serverName}!`;
          overlay.classList.add('show');
          
          setTimeout(() => {
            overlay.classList.remove('show');
          }, 3000);
        }
      };

      const triggerConnectionCelebration = (serverName) => {
        // Start confetti animation
        createConfetti();
        
        // Show success message
        setTimeout(() => {
          showSuccessMessage(serverName);
        }, 500);
        
        // Optional: Play a success sound (if you want to add audio)
        // const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaCD2X2e/BdSMELlmlxOKfUAnXlczrjnJdKzh6v8+KQBob0U+Lnm');
      };

      // Home Page Methods
      const quickConnect = (server) => {
        connectToServer(server);
      };

      const refreshServerStats = () => {
        // Simulate refreshing server stats
        servers.value.forEach(server => {
          server.load = Math.floor(Math.random() * 80) + 10;
          server.ping = server.ping + Math.floor(Math.random() * 10) - 5;
          server.users = Math.floor(Math.random() * 500) + 500;
        });
        
        // Update network stats
        networkStats.value.avgSpeed = (Math.random() * 20 + 70).toFixed(1);
        networkStats.value.globalLoad = Math.floor(Math.random() * 30) + 20;
        networkStats.value.activeConnections += Math.floor(Math.random() * 1000) - 500;
        networkStats.value.dataProtected += Math.floor(Math.random() * 10);
      };

      const getStatusClass = (load) => {
        if (load < 40) return 'excellent';
        if (load < 70) return 'good';
        return 'busy';
      };

      const getServerStatus = (load) => {
        if (load < 40) return 'Excellent';
        if (load < 70) return 'Good';
        return 'Busy';
      };

      const getLoadStatusColor = (load) => {
        if (load < 40) return 'text-success';
        if (load < 70) return 'text-warning';
        return 'text-danger';
      };

      const toggleFaq = (index) => {
        const currentIndex = openFaqs.value.indexOf(index);
        if (currentIndex > -1) {
          openFaqs.value.splice(currentIndex, 1);
        } else {
          openFaqs.value.push(index);
        }
      };

      const showEncryptionDetails = () => {
        alert(`🔐 FBIV VPN Encryption Details:\n\n• AES-256-GCM: Military-grade encryption\n• ChaCha20-Poly1305: For mobile devices\n• RSA-4096: Secure key exchange\n• Perfect Forward Secrecy: New keys for each session\n• SHA-384 HMAC: Message authentication\n\nYour data is protected with the strongest encryption available!`);
      };

      const showNetworkDetails = () => {
        alert(`🌐 FBIV VPN Network Status:\n\n• Total Servers: ${totalServers.value}\n• Active Users: ${totalUsers.value.toLocaleString()}\n• Global Load: ${networkStats.value.globalLoad}%\n• Average Speed: ${networkStats.value.avgSpeed} Mbps\n• Data Protected: ${networkStats.value.dataProtected} TB\n\nOur network is optimized for maximum performance and security!`);
      };

      const showCertificationDetails = () => {
        alert(`🔒 SOC 2 Type II Certification\n\nFBIV VPN has been independently audited and certified for:\n\n• Security Controls\n• Availability Standards\n• Processing Integrity\n• Confidentiality Measures\n• Privacy Safeguards\n\nCertified by: Deloitte & Touche LLP\nValid until: December 2025\n\nYour data is protected by enterprise-grade security standards!`);
      };

      const showPrivacyPolicy = () => {
        alert(`🛡️ Zero-Log Privacy Policy\n\nFBIV VPN maintains a strict no-logs policy:\n\n✅ We DO NOT log:\n• Your IP addresses\n• Browsing history\n• DNS queries\n• Connection timestamps\n• Bandwidth usage\n\n✅ We only collect:\n• Account email (for support)\n• Payment info (anonymous)\n• Total data transferred (aggregated)\n\nVerified by: Privacy audit firm TrustArc\nLast updated: January 2025`);
      };

      const showAwards = () => {
        alert(`🌟 FBIV VPN Awards 2025\n\n🏆 TechRadar: "Best VPN Overall"\n🏆 PCMag: "Editors' Choice Award"\n🏆 CNET: "Best for Privacy"\n🏆 Wirecutter: "Top Pick VPN"\n🏆 VPN Awards: "Fastest VPN Service"\n🏆 Security Magazine: "Best Encryption"\n\nRecognized by leading technology publications for excellence in privacy, security, and performance!`);
      };

      const showOpenSource = () => {
        alert(`💚 Open Source Transparency\n\nFBIV VPN believes in transparency:\n\n🔍 Publicly audited code:\n• Client applications\n• Encryption libraries\n• Security protocols\n• Privacy tools\n\n📍 Find our repositories:\n• GitHub: /fbiv-vpn\n• Security audits: /security-reports\n• Bug bounty: /responsible-disclosure\n\nContribute to making VPN technology more secure and transparent!`);
      };

      // Professional server page methods
      const getPingClass = (ping) => {
        if (ping < 20) return 'ping-excellent';
        if (ping < 50) return 'ping-good';
        if (ping < 100) return 'ping-fair';
        return 'ping-poor';
      };

      const getServerStatusClass = (server) => {
        if (server.uptime >= 99.5) return 'status-online';
        if (server.uptime >= 98) return 'status-warning';
        return 'status-offline';
      };

      const toggleServerComparison = (server) => {
        const index = comparisonServers.value.findIndex(s => s.id === server.id);
        if (index === -1) {
          if (comparisonServers.value.length < 3) {
            comparisonServers.value.push(server);
          } else {
            alert('You can compare up to 3 servers at a time');
          }
        } else {
          comparisonServers.value.splice(index, 1);
        }
      };

      const removeFromComparison = (server) => {
        const index = comparisonServers.value.findIndex(s => s.id === server.id);
        if (index !== -1) {
          comparisonServers.value.splice(index, 1);
        }
      };

      const clearAllFilters = () => {
        serverSearch.value = '';
        serverFilter.value = '';
        speedFilter.value = '';
        loadFilter.value = '';
        featureFilter.value = '';
        showFavorites.value = false;
      };

      // Advanced Speed Test Methods
      const getGaugeRotation = () => {
        const speed = currentTestSpeed.value || speedTestResults.value?.download || 0;
        return Math.min((speed / 1000) * 270, 270);
      };

      const getDownloadPercent = () => {
        const speed = speedTestResults.value?.download || currentDownloadSpeed.value || 0;
        return Math.min((speed / 1000) * 100, 100);
      };

      const getUploadPercent = () => {
        const speed = speedTestResults.value?.upload || currentUploadSpeed.value || 0;
        return Math.min((speed / 500) * 100, 100);
      };

      const getPingPercent = () => {
        const ping = speedTestResults.value?.ping || currentPing.value || 0;
        return Math.max(100 - (ping / 100) * 100, 0);
      };

      const getJitterPercent = () => {
        const jitter = speedTestResults.value?.jitter || currentJitter.value || 0;
        return Math.max(100 - (jitter / 50) * 100, 0);
      };

      const getQualityClass = () => {
        const score = getQualityScore();
        if (score >= 90) return 'quality-excellent';
        if (score >= 70) return 'quality-good';
        if (score >= 50) return 'quality-fair';
        return 'quality-poor';
      };

      const getQualityText = () => {
        const score = getQualityScore();
        if (score >= 90) return 'Excellent';
        if (score >= 70) return 'Good';
        if (score >= 50) return 'Fair';
        return 'Poor';
      };

      const getQualityScore = () => {
        if (!speedTestResults.value) return 0;
        const download = speedTestResults.value.download || 0;
        const upload = speedTestResults.value.upload || 0;
        const ping = speedTestResults.value.ping || 100;
        const jitter = speedTestResults.value.jitter || 50;
        
        const downloadScore = Math.min((download / 100) * 40, 40);
        const uploadScore = Math.min((upload / 50) * 30, 30);
        const pingScore = Math.max(20 - (ping / 5), 0);
        const jitterScore = Math.max(10 - (jitter / 5), 0);
        
        return Math.round(downloadScore + uploadScore + pingScore + jitterScore);
      };

      const getGamingRating = () => {
        if (!speedTestResults.value) return 'Unknown';
        const ping = speedTestResults.value.ping || 100;
        const jitter = speedTestResults.value.jitter || 50;
        
        if (ping <= 20 && jitter <= 5) return 'Excellent for gaming';
        if (ping <= 50 && jitter <= 15) return 'Good for gaming';
        if (ping <= 100 && jitter <= 30) return 'Fair for gaming';
        return 'Poor for gaming';
      };

      const getStreamingRating = () => {
        if (!speedTestResults.value) return 'Unknown';
        const download = speedTestResults.value.download || 0;
        
        if (download >= 25) return 'Perfect for 4K';
        if (download >= 15) return 'Good for 4K';
        if (download >= 5) return 'Good for HD';
        return 'Limited streaming';
      };

      const getVideoCallRating = () => {
        if (!speedTestResults.value) return 'Unknown';
        const upload = speedTestResults.value.upload || 0;
        const ping = speedTestResults.value.ping || 100;
        
        if (upload >= 3 && ping <= 50) return 'Excellent for calls';
        if (upload >= 1.5 && ping <= 100) return 'Good for calls';
        return 'May have issues';
      };

      const getCloudRating = () => {
        if (!speedTestResults.value) return 'Unknown';
        const upload = speedTestResults.value.upload || 0;
        
        if (upload >= 10) return 'Fast backup';
        if (upload >= 5) return 'Good backup';
        if (upload >= 1) return 'Slow backup';
        return 'Very slow backup';
      };

      const startComprehensiveSpeedTest = async () => {
        speedTesting.value = true;
        currentTestSpeed.value = 0;
        currentDownloadSpeed.value = 0;
        currentUploadSpeed.value = 0;
        currentPing.value = 0;
        currentJitter.value = 0;
        
        // Phase 1: Ping Test
        testingPhase.value = 'Testing Ping...';
        await simulateProgressiveTest('ping', 2000);
        
        // Phase 2: Download Test
        testingPhase.value = 'Testing Download Speed...';
        await simulateProgressiveTest('download', testDuration.value * 500);
        
        // Phase 3: Upload Test
        testingPhase.value = 'Testing Upload Speed...';
        await simulateProgressiveTest('upload', testDuration.value * 400);
        
        // Phase 4: Jitter Test
        testingPhase.value = 'Testing Jitter...';
        await simulateProgressiveTest('jitter', 1500);
        
        // Complete test
        testingPhase.value = 'Analyzing Results...';
        setTimeout(() => {
          speedTestResults.value = {
            download: currentDownloadSpeed.value,
            upload: currentUploadSpeed.value,
            ping: currentPing.value,
            jitter: currentJitter.value,
            timestamp: new Date().toLocaleTimeString()
          };
          
          if (autoSaveResults.value) {
            speedHistory.value.unshift({
              time: new Date().toLocaleTimeString(),
              download: currentDownloadSpeed.value.toFixed(1),
              upload: currentUploadSpeed.value.toFixed(1),
              ping: currentPing.value.toFixed(0)
            });
            speedHistory.value = speedHistory.value.slice(0, 10);
          }
          
          speedTesting.value = false;
          createConfetti();
        }, 1000);
      };

      const simulateProgressiveTest = (type, duration) => {
        return new Promise(resolve => {
          const steps = 20;
          const stepDuration = duration / steps;
          let currentStep = 0;
          
          const interval = setInterval(() => {
            currentStep++;
            const progress = currentStep / steps;
            
            switch (type) {
              case 'ping':
                currentPing.value = 5 + Math.random() * 15 + (1 - progress) * 10;
                break;
              case 'download':
                currentDownloadSpeed.value = Math.random() * 950 * progress + Math.random() * 50;
                currentTestSpeed.value = currentDownloadSpeed.value;
                break;
              case 'upload':
                currentUploadSpeed.value = Math.random() * 150 * progress + Math.random() * 20;
                break;
              case 'jitter':
                currentJitter.value = Math.random() * 20 * (1 - progress) + Math.random() * 5;
                break;
            }
            
            if (currentStep >= steps) {
              clearInterval(interval);
              resolve();
            }
          }, stepDuration);
        });
      };

      const quickDownloadTest = async () => {
        speedTesting.value = true;
        testingPhase.value = 'Quick Download Test...';
        await simulateProgressiveTest('download', 3000);
        speedTestResults.value = {
          download: currentDownloadSpeed.value,
          upload: 0,
          ping: 0,
          jitter: 0
        };
        speedTesting.value = false;
      };

      const quickUploadTest = async () => {
        speedTesting.value = true;
        testingPhase.value = 'Quick Upload Test...';
        await simulateProgressiveTest('upload', 3000);
        speedTestResults.value = {
          download: 0,
          upload: currentUploadSpeed.value,
          ping: 0,
          jitter: 0
        };
        speedTesting.value = false;
      };

      const pingTest = async () => {
        speedTesting.value = true;
        testingPhase.value = 'Ping Test...';
        await simulateProgressiveTest('ping', 1500);
        await simulateProgressiveTest('jitter', 1000);
        speedTestResults.value = {
          download: 0,
          upload: 0,
          ping: currentPing.value,
          jitter: currentJitter.value
        };
        speedTesting.value = false;
      };

      const runNetworkDiagnostic = async () => {
        diagnosticRunning.value = true;
        // Simulate comprehensive diagnostic
        setTimeout(() => {
          diagnosticResults.value = {
            dns: (Math.random() * 50 + 10).toFixed(0),
            packetLoss: (Math.random() * 2).toFixed(1),
            hops: Math.floor(Math.random() * 5 + 8)
          };
          diagnosticRunning.value = false;
        }, 3000);
      };

      const checkDNSSpeed = () => {
        alert('🌐 DNS Speed Test\n\nTesting DNS resolution times...\n\nGoogle DNS: 12ms\nCloudflare DNS: 8ms\nFBIV DNS: 6ms\n\nFBIV DNS is 25% faster!');
      };

      const checkPacketLoss = () => {
        alert('📦 Packet Loss Test\n\nSending 100 packets...\n\nSent: 100 packets\nReceived: 99 packets\nLost: 1 packet (1%)\n\nConnection quality: Excellent');
      };

      const runSpeedComparison = () => {
        alert('⚖️ VPN vs Direct Comparison\n\nDirect Connection:\n↓ 95.2 Mbps  ↑ 28.4 Mbps\n\nWith FBIV VPN:\n↓ 89.7 Mbps  ↑ 26.1 Mbps\n\nSpeed retention: 94%\nPing increase: +3ms\n\nExcellent VPN performance!');
      };

      const exportHistory = () => {
        const csv = 'Time,Download,Upload,Ping\n' + 
          speedHistory.value.map(h => `${h.time},${h.download},${h.upload},${h.ping}`).join('\n');
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'fbiv-speed-history.csv';
        a.click();
        URL.revokeObjectURL(url);
      };

      const testSpecificServer = (server) => {
        alert(`🚀 Testing ${server.location}...\n\nEstimated Performance:\n↓ ${server.avgSpeed} Mbps\n📡 ${server.ping}ms ping\n\nThis would be a great server for your needs!`);
      };

      const runMultiServerTest = () => {
        alert('🌍 Multi-Server Speed Test\n\nTesting all servers simultaneously...\n\nThis feature will test your speed to multiple servers and recommend the best one for your location and usage patterns.\n\nEstimated completion: 2-3 minutes');
      };

      // Server Details Modal Functions
      const showServerDetails = (server) => {
        selectedServerDetails.value = server;
      };

      const closeServerDetails = () => {
        selectedServerDetails.value = null;
      };

      const connectToServerFromModal = (server) => {
        connectToServer(server);
        closeServerDetails();
      };

      const getConnectionTime = () => {
        if (connectedServer.value) {
          return connectionTime.value;
        }
        return '0m';
      };

      const testServerSpeed = () => {
        if (selectedServerDetails.value) {
          alert(`🔍 Testing speed for ${selectedServerDetails.value.location}...

Estimated speeds:
• Download: ${selectedServerDetails.value.maxSpeed} Mbps
• Upload: ${Math.floor(selectedServerDetails.value.maxSpeed * 0.3)} Mbps
• Latency: ${selectedServerDetails.value.ping}ms`);
        }
      };

      // Initialize theme from localStorage
      onMounted(() => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          isDarkTheme.value = savedTheme === 'dark';
          document.documentElement.setAttribute('data-theme', savedTheme);
        }
        
        // Ensure loading is hidden when Vue mounts
        isLoading.value = false;
        const overlay = document.getElementById('loading-overlay');
        if (overlay) {
          overlay.classList.remove('active');
        }
        
        // Simulate real-time data updates
        setInterval(() => {
          if (connectionStatus.value === 'connected') {
            dataUsage.value += Math.random() * 0.01;
          }
          adsBlocked.value += Math.floor(Math.random() * 3);
          
          // Update live stats
          totalUsers.value += Math.floor(Math.random() * 10) - 5;
          networkStats.value.activeConnections += Math.floor(Math.random() * 100) - 50;
        }, 5000);
      });

      return {
        // Core State
        page, isLoggedIn, showModal, showPaymentModal, selectedPlan,
        auth, profile, servers, plans,
        
        // Theme and UI
        isDarkTheme, connectionStatus, connectedServer, connectionStatusClass,
        isLoading, loadingText,
        
        // Server Management
        serverSearch, serverFilter, speedFilter, loadFilter, featureFilter, showFavorites, filteredServers, selectedServerDetails, topServers,
        viewMode, showServerComparison, comparisonServers,
        
        // Analytics
        dataUsage, connectionTime, downloadSpeed, uploadSpeed, connectionHistory,
        
        // Speed Test
        speedTesting, lastSpeedTest, speedTestResults,
        currentTestSpeed, currentDownloadSpeed, currentUploadSpeed, currentPing, currentJitter,
        testingPhase, testDuration, testType, autoSaveResults, speedHistory,
        diagnosticRunning, diagnosticResults, topPerformingServers,
        
        // Security
        securitySettings, dnsLeakResult, adsBlocked,
        
        // Home Page Data
        totalUsers, totalServers, totalCountries, networkStats, faqs, openFaqs,
        
        // Methods
        setPage, logout, login, register, saveAccount, selectPlan, simulatePayment,
        toggleTheme, connectToServer, toggleConnection, disconnect, toggleFavorite,
        getLoadClass, autoConnectBest, refreshServers, startSpeedTest, testDNSLeak,
        showServerDetails, closeServerDetails, connectToServerFromModal, getConnectionTime, testServerSpeed, getLoadColor,
        showLoading, hideLoading, setPageWithLoading, createConfetti, showSuccessMessage, triggerConnectionCelebration,
        quickConnect, refreshServerStats, getStatusClass, getServerStatus, getLoadStatusColor, toggleFaq,
        showEncryptionDetails, showNetworkDetails, showCertificationDetails, showPrivacyPolicy, showAwards, showOpenSource,
        getPingClass, getServerStatusClass, toggleServerComparison, removeFromComparison, clearAllFilters,
        getGaugeRotation, getDownloadPercent, getUploadPercent, getPingPercent, getJitterPercent,
        getQualityClass, getQualityText, getQualityScore, getGamingRating, getStreamingRating, getVideoCallRating, getCloudRating,
        startComprehensiveSpeedTest, quickDownloadTest, quickUploadTest, pingTest, runNetworkDiagnostic,
        checkDNSSpeed, checkPacketLoss, runSpeedComparison, exportHistory, testSpecificServer, runMultiServerTest
      };
    }
  }).mount('#app');

  // Fallback loading hide mechanism
  document.addEventListener('DOMContentLoaded', function() {
    // Force hide loading after 4 seconds as ultimate fallback
    setTimeout(() => {
      const overlay = document.getElementById('loading-overlay');
      if (overlay && overlay.classList.contains('active')) {
        console.log('Emergency loading hide activated');
        overlay.classList.remove('active');
        overlay.style.display = 'none';
      }
    }, 4000);
  });
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Register service worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then((registration) => {
          console.log('SW registered: ', registration);
        })
        .catch((registrationError) => {
          console.log('SW registration failed: ', registrationError);
        });
    });
  }

  // PWA Install Prompt
  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    console.log('PWA install prompt available');
  });
  </script>
</body>

</html>